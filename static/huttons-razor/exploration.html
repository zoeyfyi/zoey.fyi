<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>exploration</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Markup">```
</a><a id="5" class="Symbol">{-#</a> <a id="9" class="Keyword">OPTIONS</a> <a id="17" class="Pragma">--cubical</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
<a id="101" class="Keyword">open</a> <a id="106" class="Keyword">import</a> <a id="113" href="Cubical.Foundations.Function.html" class="Module">Cubical.Foundations.Function</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Cubical.Foundations.HLevels.html" class="Module">Cubical.Foundations.HLevels</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a> <a id="212" class="Keyword">using</a> <a id="218" class="Symbol">(</a><a id="219" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="221" class="Symbol">;</a> <a id="223" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="226" class="Symbol">;</a> <a id="228" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="232" class="Symbol">)</a>
<a id="234" class="Keyword">open</a> <a id="239" class="Keyword">import</a> <a id="246" href="Cubical.HITs.SetQuotients.html" class="Module">Cubical.HITs.SetQuotients</a> <a id="272" class="Keyword">renaming</a> <a id="281" class="Symbol">(</a><a id="282" href="Cubical.HITs.SetQuotients.Base.html#289" class="InductiveConstructor Operator">[_]</a> <a id="286" class="Symbol">to</a> <a id="289" class="InductiveConstructor Operator">[[_]]</a><a id="294" class="Symbol">)</a>
<a id="296" class="Keyword">open</a> <a id="301" class="Keyword">import</a> <a id="308" href="Cubical.Reflection.Base.html" class="Module">Cubical.Reflection.Base</a>


<a id="334" class="Keyword">private</a>
  <a id="344" class="Keyword">variable</a>
    <a id="357" href="exploration.html#357" class="Generalizable">a</a> <a id="359" href="exploration.html#359" class="Generalizable">b</a> <a id="361" href="exploration.html#361" class="Generalizable">c</a> <a id="363" class="Symbol">:</a> <a id="365" href="Agda.Primitive.html#597" class="Postulate">Level</a>
    <a id="375" href="exploration.html#375" class="Generalizable">A</a> <a id="377" href="exploration.html#377" class="Generalizable">B</a> <a id="379" href="exploration.html#379" class="Generalizable">C</a> <a id="381" class="Symbol">:</a> <a id="383" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="388" href="exploration.html#357" class="Generalizable">a</a>
    <a id="394" href="exploration.html#394" class="Generalizable">n</a> <a id="396" href="exploration.html#396" class="Generalizable">m</a> <a id="398" class="Symbol">:</a> <a id="400" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="402" class="Markup">```
</a><a id="406" class="Background">
# Utils

</a><a id="416" class="Markup">```
</a><a id="id"></a><a id="420" href="exploration.html#420" class="Function">id</a> <a id="423" class="Symbol">:</a> <a id="425" href="exploration.html#375" class="Generalizable">A</a> <a id="427" class="Symbol">→</a> <a id="429" href="exploration.html#375" class="Generalizable">A</a>
<a id="431" href="exploration.html#420" class="Function">id</a> <a id="434" href="exploration.html#434" class="Bound">x</a> <a id="436" class="Symbol">=</a> <a id="438" href="exploration.html#434" class="Bound">x</a>
<a id="440" class="Markup">```
</a><a id="444" class="Background">
Some missing bits for `Vec`&#39;s

</a><a id="476" class="Markup">```
</a><a id="480" class="Keyword">module</a> <a id="487" href="exploration.html#487" class="Module">_</a> <a id="489" class="Keyword">where</a> 

  <a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a>  <a id="512" href="Cubical.Data.Vec.html" class="Module">Cubical.Data.Vec</a>

  <a id="532" href="exploration.html#532" class="Function Operator">_∷ʳ_</a> <a id="537" class="Symbol">:</a> <a id="539" class="Symbol">(</a><a id="540" href="exploration.html#540" class="Bound">xs</a> <a id="543" class="Symbol">:</a> <a id="545" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="549" href="exploration.html#375" class="Generalizable">A</a> <a id="551" href="exploration.html#394" class="Generalizable">n</a><a id="552" class="Symbol">)</a> <a id="554" class="Symbol">→</a> <a id="556" href="exploration.html#375" class="Generalizable">A</a> <a id="558" class="Symbol">→</a> <a id="560" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="564" href="exploration.html#375" class="Generalizable">A</a> <a id="566" class="Symbol">(</a><a id="567" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="571" href="exploration.html#394" class="Generalizable">n</a><a id="572" class="Symbol">)</a>
  <a id="576" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="579" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="582" href="exploration.html#582" class="Bound">x</a> <a id="584" class="Symbol">=</a> <a id="586" href="exploration.html#582" class="Bound">x</a> <a id="588" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="590" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>
  <a id="595" class="Symbol">(</a><a id="596" href="exploration.html#596" class="Bound">y</a> <a id="598" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="600" href="exploration.html#600" class="Bound">xs</a><a id="602" class="Symbol">)</a> <a id="604" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="607" href="exploration.html#607" class="Bound">x</a> <a id="609" class="Symbol">=</a> <a id="611" href="exploration.html#596" class="Bound">y</a> <a id="613" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="615" class="Symbol">(</a><a id="616" href="exploration.html#600" class="Bound">xs</a> <a id="619" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="622" href="exploration.html#607" class="Bound">x</a><a id="623" class="Symbol">)</a>

  <a id="628" href="exploration.html#628" class="Function">∷ʳ-unit</a> <a id="636" class="Symbol">:</a> <a id="638" class="Symbol">(</a><a id="639" href="exploration.html#639" class="Bound">x</a> <a id="641" class="Symbol">:</a> <a id="643" href="exploration.html#375" class="Generalizable">A</a><a id="644" class="Symbol">)</a> <a id="646" class="Symbol">→</a> <a id="648" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="651" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="654" href="exploration.html#639" class="Bound">x</a> <a id="656" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="658" href="exploration.html#639" class="Bound">x</a> <a id="660" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="662" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>
  <a id="667" href="exploration.html#628" class="Function">∷ʳ-unit</a> <a id="675" href="exploration.html#675" class="Bound">x</a> <a id="677" class="Symbol">=</a> <a id="679" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
<a id="684" class="Markup">```
</a><a id="688" class="Background">

# Fold and Unfold for Program Semantics

According to this [stackoverflow answer](https://stackoverflow.com/a/17871786), this is where Hutton&#39;s razor was first defined. The paper demonstrates how folding over a syntax tree corresponds to denotational semantics (think expression evaluation), and unfolding a tree corresponds to operational semantics.

We extend the arithmetic expression with an equation stating that the add constructor must be commutative.

</a><a id="1150" class="Markup">```
</a><a id="1154" class="Keyword">data</a> <a id="Hutton"></a><a id="1159" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="1166" class="Symbol">:</a> <a id="1168" href="Agda.Primitive.html#326" class="Primitive">Type₀</a> <a id="1174" class="Keyword">where</a>
  <a id="Hutton.val"></a><a id="1182" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="exploration.html#1159" class="Datatype">Hutton</a>
  <a id="Hutton.add"></a><a id="1201" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="1205" class="Symbol">:</a> <a id="1207" class="Symbol">(</a><a id="1208" href="exploration.html#1208" class="Bound">t₁</a> <a id="1211" href="exploration.html#1211" class="Bound">t₂</a> <a id="1214" class="Symbol">:</a> <a id="1216" href="exploration.html#1159" class="Datatype">Hutton</a><a id="1222" class="Symbol">)</a> <a id="1224" class="Symbol">→</a> <a id="1226" href="exploration.html#1159" class="Datatype">Hutton</a>
  <a id="Hutton.comm"></a><a id="1235" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="1240" class="Symbol">:</a> <a id="1242" class="Symbol">∀</a> <a id="1244" href="exploration.html#1244" class="Bound">n</a> <a id="1246" href="exploration.html#1246" class="Bound">m</a> <a id="1248" class="Symbol">→</a> <a id="1250" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="1254" href="exploration.html#1244" class="Bound">n</a> <a id="1256" href="exploration.html#1246" class="Bound">m</a> <a id="1258" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1260" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="1264" href="exploration.html#1246" class="Bound">m</a> <a id="1266" href="exploration.html#1244" class="Bound">n</a>

<a id="⟦_⟧"></a><a id="1269" href="exploration.html#1269" class="Function Operator">⟦_⟧</a> <a id="1273" class="Symbol">:</a> <a id="1275" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1286" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1288" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="1292" href="exploration.html#1292" class="Bound">n</a> <a id="1294" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1296" class="Symbol">=</a> <a id="1298" href="exploration.html#1292" class="Bound">n</a>
<a id="1300" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1302" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="1306" href="exploration.html#1306" class="Bound">t₁</a> <a id="1309" href="exploration.html#1309" class="Bound">t₂</a> <a id="1312" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1314" class="Symbol">=</a> <a id="1316" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1318" href="exploration.html#1306" class="Bound">t₁</a> <a id="1321" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1323" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1325" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1327" href="exploration.html#1309" class="Bound">t₂</a> <a id="1330" href="exploration.html#1269" class="Function Operator">⟧</a>
<a id="1332" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1334" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="1339" href="exploration.html#1339" class="Bound">t₁</a> <a id="1342" href="exploration.html#1342" class="Bound">t₂</a> <a id="1345" href="exploration.html#1345" class="Bound">i</a> <a id="1347" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1349" class="Symbol">=</a> <a id="1351" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="1358" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1360" href="exploration.html#1339" class="Bound">t₁</a> <a id="1363" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1365" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="1367" href="exploration.html#1342" class="Bound">t₂</a> <a id="1370" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="1372" href="exploration.html#1345" class="Bound">i</a>
<a id="1374" class="Markup">```
</a><a id="1378" class="Background">
Proof of decidable equality gets tricky

</a><a id="1420" class="Markup">```
</a><a id="1424" class="Keyword">module</a> <a id="1431" href="exploration.html#1431" class="Module">_</a> <a id="1433" class="Keyword">where</a>

  <a id="1442" class="Keyword">open</a> <a id="1447" class="Keyword">import</a> <a id="1454" href="Cubical.Relation.Nullary.html" class="Module">Cubical.Relation.Nullary</a>
  <a id="1481" class="Keyword">open</a> <a id="1486" class="Keyword">import</a> <a id="1493" href="Cubical.Data.Empty.html" class="Module">Cubical.Data.Empty</a>

  <a id="1515" class="Comment">-- Proof simular to Cubical.Data.Nat</a>

  <a id="1555" href="exploration.html#1555" class="Function">caseHutton</a> <a id="1566" class="Symbol">:</a> <a id="1568" class="Symbol">∀</a> <a id="1570" class="Symbol">{</a><a id="1571" href="exploration.html#1571" class="Bound">ℓ</a><a id="1572" class="Symbol">}</a> <a id="1574" class="Symbol">{</a><a id="1575" href="exploration.html#1575" class="Bound">A</a> <a id="1577" class="Symbol">:</a> <a id="1579" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1584" href="exploration.html#1571" class="Bound">ℓ</a><a id="1585" class="Symbol">}</a> <a id="1587" class="Symbol">(</a><a id="1588" href="exploration.html#1588" class="Bound">av</a> <a id="1591" href="exploration.html#1591" class="Bound">aa</a> <a id="1594" class="Symbol">:</a> <a id="1596" href="exploration.html#1575" class="Bound">A</a><a id="1597" class="Symbol">)</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="1608" class="Symbol">→</a> <a id="1610" href="exploration.html#1575" class="Bound">A</a>
  <a id="1614" href="exploration.html#1555" class="Function">caseHutton</a> <a id="1625" href="exploration.html#1625" class="Bound">av</a> <a id="1628" href="exploration.html#1628" class="Bound">aa</a> <a id="1631" class="Symbol">(</a><a id="1632" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="1636" class="Symbol">_)</a> <a id="1639" class="Symbol">=</a> <a id="1641" href="exploration.html#1625" class="Bound">av</a>
  <a id="1646" href="exploration.html#1555" class="Function">caseHutton</a> <a id="1657" href="exploration.html#1657" class="Bound">av</a> <a id="1660" href="exploration.html#1660" class="Bound">aa</a> <a id="1663" class="Symbol">(</a><a id="1664" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="1668" class="Symbol">_</a> <a id="1670" class="Symbol">_)</a> <a id="1673" class="Symbol">=</a> <a id="1675" href="exploration.html#1660" class="Bound">aa</a>
  <a id="1680" href="exploration.html#1555" class="Function">caseHutton</a> <a id="1691" href="exploration.html#1691" class="Bound">av</a> <a id="1694" href="exploration.html#1694" class="Bound">aa</a> <a id="1697" class="Symbol">(</a><a id="1698" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="1703" href="exploration.html#1703" class="Bound">t</a> <a id="1705" href="exploration.html#1705" class="Bound">t₁</a> <a id="1708" href="exploration.html#1708" class="Bound">i</a><a id="1709" class="Symbol">)</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="exploration.html#1694" class="Bound">aa</a>

  <a id="1719" href="exploration.html#1719" class="Function">injVal</a> <a id="1726" class="Symbol">:</a> <a id="1728" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="1732" href="exploration.html#396" class="Generalizable">m</a> <a id="1734" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1736" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="1740" href="exploration.html#394" class="Generalizable">n</a> <a id="1742" class="Symbol">→</a> <a id="1744" href="exploration.html#396" class="Generalizable">m</a> <a id="1746" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1748" href="exploration.html#394" class="Generalizable">n</a>
  <a id="1752" href="exploration.html#1719" class="Function">injVal</a> <a id="1759" href="exploration.html#1759" class="Bound">p</a> <a id="1761" class="Symbol">=</a> <a id="1763" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="1768" href="exploration.html#1269" class="Function Operator">⟦_⟧</a> <a id="1772" href="exploration.html#1759" class="Bound">p</a>

  <a id="1777" class="Comment">-- discreteHutton : Discrete Hutton</a>
  <a id="1815" class="Comment">-- discreteHutton (val x) (val y) with discreteℕ x y </a>
  <a id="1871" class="Comment">-- ... | yes p = yes (λ i → val (p i))</a>
  <a id="1912" class="Comment">-- ... | no ¬p = no λ q → ¬p (injVal q)</a>
  <a id="1954" class="Comment">-- discreteHutton (val x) (add y y₁) = no (λ p → subst (caseHutton Unit ⊥) p tt)</a>
  <a id="2037" class="Comment">-- discreteHutton (val x) (comm y y₁ i) = no (λ p → subst (caseHutton Unit ⊥) p tt)</a>
  <a id="2123" class="Comment">-- discreteHutton (add x x₁) (val x₂) = no (λ p → subst (caseHutton ⊥ Unit) p tt)</a>
  
  <a id="2210" class="Comment">-- need to test equality of all 4 subtrees here but how to refute if add isn&#39;t injective</a>
  <a id="2301" class="Comment">-- need some notion of &quot;injective up to commutativity&quot;</a>
  
  <a id="2361" class="Comment">-- discreteHutton (add x₁ x₂) (add y₁ y₂) with discreteHutton x₁ y₁ | discreteHutton x₂ y₂</a>
  <a id="2454" class="Comment">-- ... | yes p | yes q = yes (cong₂ add p q)</a>
  <a id="2501" class="Comment">-- ... | yes p | no ¬p = {!   !}</a>
  <a id="2536" class="Comment">-- ... | no ¬p | bar = {!   !}</a>
  <a id="2569" class="Comment">-- discreteHutton (add x x₁) (comm y y₁ i) = {!   !}</a>
  <a id="2624" class="Comment">-- discreteHutton (comm x x₁ i) y = {!   !}</a>
<a id="2668" class="Markup">```
</a><a id="2672" class="Background">
## Denotational semantics

</a><a id="2700" class="Markup">```
</a><a id="2704" class="Keyword">module</a> <a id="2711" href="exploration.html#2711" class="Module">_</a> <a id="2713" class="Symbol">(</a><a id="2714" href="exploration.html#2714" class="Bound">f</a> <a id="2716" class="Symbol">:</a> <a id="2718" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2720" class="Symbol">→</a> <a id="2722" href="exploration.html#375" class="Generalizable">A</a><a id="2723" class="Symbol">)</a> <a id="2725" class="Symbol">(</a><a id="2726" href="exploration.html#2726" class="Bound">g</a> <a id="2728" class="Symbol">:</a> <a id="2730" href="exploration.html#375" class="Generalizable">A</a> <a id="2732" class="Symbol">→</a> <a id="2734" href="exploration.html#375" class="Generalizable">A</a> <a id="2736" class="Symbol">→</a> <a id="2738" href="exploration.html#375" class="Generalizable">A</a><a id="2739" class="Symbol">)</a> <a id="2741" class="Symbol">(</a><a id="2742" href="exploration.html#2742" class="Bound">g-comm</a> <a id="2749" class="Symbol">:</a> <a id="2751" class="Symbol">∀</a> <a id="2753" href="exploration.html#2753" class="Bound">t₁</a> <a id="2756" href="exploration.html#2756" class="Bound">t₂</a> <a id="2759" class="Symbol">→</a> <a id="2761" href="exploration.html#2726" class="Bound">g</a> <a id="2763" href="exploration.html#2753" class="Bound">t₁</a> <a id="2766" href="exploration.html#2756" class="Bound">t₂</a> <a id="2769" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2771" href="exploration.html#2726" class="Bound">g</a> <a id="2773" href="exploration.html#2756" class="Bound">t₂</a> <a id="2776" href="exploration.html#2753" class="Bound">t₁</a><a id="2778" class="Symbol">)</a> <a id="2780" class="Keyword">where</a>

  <a id="2789" href="exploration.html#2789" class="Function">fold</a> <a id="2794" class="Symbol">:</a> <a id="2796" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="2803" class="Symbol">→</a> <a id="2805" href="exploration.html#2722" class="Bound">A</a>
  <a id="2809" href="exploration.html#2789" class="Function">fold</a> <a id="2814" class="Symbol">(</a><a id="2815" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="2819" href="exploration.html#2819" class="Bound">x</a><a id="2820" class="Symbol">)</a> <a id="2822" class="Symbol">=</a> <a id="2824" href="exploration.html#2714" class="Bound">f</a> <a id="2826" href="exploration.html#2819" class="Bound">x</a>
  <a id="2830" href="exploration.html#2789" class="Function">fold</a> <a id="2835" class="Symbol">(</a><a id="2836" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="2840" href="exploration.html#2840" class="Bound">l</a> <a id="2842" href="exploration.html#2842" class="Bound">r</a><a id="2843" class="Symbol">)</a> <a id="2845" class="Symbol">=</a> <a id="2847" href="exploration.html#2726" class="Bound">g</a> <a id="2849" class="Symbol">(</a><a id="2850" href="exploration.html#2789" class="Function">fold</a> <a id="2855" href="exploration.html#2840" class="Bound">l</a><a id="2856" class="Symbol">)</a> <a id="2858" class="Symbol">(</a><a id="2859" href="exploration.html#2789" class="Function">fold</a> <a id="2864" href="exploration.html#2842" class="Bound">r</a><a id="2865" class="Symbol">)</a>
  <a id="2869" href="exploration.html#2789" class="Function">fold</a> <a id="2874" class="Symbol">(</a><a id="2875" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="2880" href="exploration.html#2880" class="Bound">t₁</a> <a id="2883" href="exploration.html#2883" class="Bound">t₂</a> <a id="2886" href="exploration.html#2886" class="Bound">i</a><a id="2887" class="Symbol">)</a> <a id="2889" class="Symbol">=</a> <a id="2891" href="exploration.html#2742" class="Bound">g-comm</a> <a id="2898" class="Symbol">(</a><a id="2899" href="exploration.html#2789" class="Function">fold</a> <a id="2904" href="exploration.html#2880" class="Bound">t₁</a><a id="2906" class="Symbol">)</a> <a id="2908" class="Symbol">(</a><a id="2909" href="exploration.html#2789" class="Function">fold</a> <a id="2914" href="exploration.html#2883" class="Bound">t₂</a><a id="2916" class="Symbol">)</a> <a id="2918" href="exploration.html#2886" class="Bound">i</a>

<a id="⟦⟧-fold"></a><a id="2921" href="exploration.html#2921" class="Function">⟦⟧-fold</a> <a id="2929" class="Symbol">:</a> <a id="2931" href="exploration.html#1269" class="Function Operator">⟦_⟧</a> <a id="2935" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2937" href="exploration.html#2789" class="Function">fold</a> <a id="2942" href="exploration.html#420" class="Function">id</a> <a id="2945" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="2949" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a>
<a id="2956" href="exploration.html#2921" class="Function">⟦⟧-fold</a> <a id="2964" class="Symbol">=</a> <a id="2966" href="Cubical.Foundations.Prelude.html#8074" class="Function">funExt</a> <a id="2973" href="exploration.html#2989" class="Function">lemma</a>
  <a id="2981" class="Keyword">where</a>
  <a id="2989" href="exploration.html#2989" class="Function">lemma</a> <a id="2995" class="Symbol">:</a> <a id="2997" class="Symbol">(</a><a id="2998" href="exploration.html#2998" class="Bound">t</a> <a id="3000" class="Symbol">:</a> <a id="3002" href="exploration.html#1159" class="Datatype">Hutton</a><a id="3008" class="Symbol">)</a> <a id="3010" class="Symbol">→</a> <a id="3012" href="exploration.html#1269" class="Function Operator">⟦</a> <a id="3014" href="exploration.html#2998" class="Bound">t</a> <a id="3016" href="exploration.html#1269" class="Function Operator">⟧</a> <a id="3018" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3020" href="exploration.html#2789" class="Function">fold</a> <a id="3025" href="exploration.html#420" class="Function">id</a> <a id="3028" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="3032" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="3039" href="exploration.html#2998" class="Bound">t</a>
  <a id="3043" href="exploration.html#2989" class="Function">lemma</a> <a id="3049" class="Symbol">(</a><a id="3050" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="3054" href="exploration.html#3054" class="Bound">x</a><a id="3055" class="Symbol">)</a> <a id="3057" class="Symbol">=</a> <a id="3059" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
  <a id="3066" href="exploration.html#2989" class="Function">lemma</a> <a id="3072" class="Symbol">(</a><a id="3073" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="3077" href="exploration.html#3077" class="Bound">t₁</a> <a id="3080" href="exploration.html#3080" class="Bound">t₂</a><a id="3082" class="Symbol">)</a> <a id="3084" class="Symbol">=</a> <a id="3086" href="Cubical.Foundations.Prelude.html#1236" class="Function">cong₂</a> <a id="3092" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="3096" class="Symbol">(</a><a id="3097" href="exploration.html#2989" class="Function">lemma</a> <a id="3103" href="exploration.html#3077" class="Bound">t₁</a><a id="3105" class="Symbol">)</a> <a id="3107" class="Symbol">(</a><a id="3108" href="exploration.html#2989" class="Function">lemma</a> <a id="3114" href="exploration.html#3080" class="Bound">t₂</a><a id="3116" class="Symbol">)</a>
  <a id="3120" href="exploration.html#2989" class="Function">lemma</a> <a id="3126" class="Symbol">(</a><a id="3127" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="3132" href="exploration.html#3132" class="Bound">t₁</a> <a id="3135" href="exploration.html#3135" class="Bound">t₂</a> <a id="3138" href="exploration.html#3138" class="Bound">i</a><a id="3139" class="Symbol">)</a> <a id="3141" href="exploration.html#3141" class="Bound">j</a> <a id="3143" class="Symbol">=</a> <a id="3145" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="3152" class="Symbol">(</a><a id="3153" href="exploration.html#2989" class="Function">lemma</a> <a id="3159" href="exploration.html#3132" class="Bound">t₁</a> <a id="3162" href="exploration.html#3141" class="Bound">j</a><a id="3163" class="Symbol">)</a> <a id="3165" class="Symbol">(</a><a id="3166" href="exploration.html#2989" class="Function">lemma</a> <a id="3172" href="exploration.html#3135" class="Bound">t₂</a> <a id="3175" href="exploration.html#3141" class="Bound">j</a><a id="3176" class="Symbol">)</a> <a id="3178" href="exploration.html#3138" class="Bound">i</a>
<a id="3180" class="Markup">```
</a><a id="3184" class="Background">
Compiling to stack machine instructions presents the first major problem. While programming with with the commutative equation above amounted to ensuring the invariant was held by the respective function, when transforming commutative hutton to a data structure it too must respect the equivalence class. Consider the tree `add (val 3) (val 4)`, under the equivalence class this can be compiled two ways:

- `[push 3, push 4, add]`
- `[push 4, push 3, add]`

For lists these are obviously not equivalent. Fundementally we need to prove `op` is commutative in and:

```none
compile (add xs ys) = op xs ys
op xs ys = xs +++ ys +++ [ add ]
```

We need to ensure that program xs ys are &quot;self contained&quot;, i.e. there evaluation doesn&#39;t depend on the input stack, for example:

`[ add ] +++ [ push 10 , push 20 ]` differs from `[ push 10 , push 20 ] +++ [ add ]` depending on the input stack.

The solution ([from Connor McBride](https://gist.github.com/thoughtpolice/3841904)) is to index instructions by indices representing the input stack size and output stack size.

</a><a id="4251" class="Markup">```
</a><a id="4255" class="Keyword">module</a> <a id="StackEval"></a><a id="4262" href="exploration.html#4262" class="Module">StackEval</a> <a id="4272" class="Keyword">where</a>

  <a id="4281" class="Keyword">open</a> <a id="4286" class="Keyword">import</a> <a id="4293" href="Cubical.Data.Vec.html" class="Module">Cubical.Data.Vec</a>

  <a id="4313" class="Keyword">data</a> <a id="StackEval.Inst"></a><a id="4318" href="exploration.html#4318" class="Datatype">Inst</a> <a id="4323" class="Symbol">:</a> <a id="4325" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4327" class="Symbol">→</a> <a id="4329" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4331" class="Symbol">→</a> <a id="4333" href="Agda.Primitive.html#326" class="Primitive">Type₀</a> <a id="4339" class="Keyword">where</a>
    <a id="StackEval.Inst.add"></a><a id="4349" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="4353" class="Symbol">:</a> <a id="4355" class="Symbol">∀</a> <a id="4357" class="Symbol">{</a><a id="4358" href="exploration.html#4358" class="Bound">n</a><a id="4359" class="Symbol">}</a> <a id="4361" class="Symbol">→</a> <a id="4363" href="exploration.html#4318" class="Datatype">Inst</a> <a id="4368" class="Symbol">(</a><a id="4369" class="Number">2</a> <a id="4371" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4373" href="exploration.html#4358" class="Bound">n</a><a id="4374" class="Symbol">)</a> <a id="4376" class="Symbol">(</a><a id="4377" class="Number">1</a> <a id="4379" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4381" href="exploration.html#4358" class="Bound">n</a><a id="4382" class="Symbol">)</a>
    <a id="StackEval.Inst.push"></a><a id="4388" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="4393" class="Symbol">:</a> <a id="4395" class="Symbol">∀</a> <a id="4397" class="Symbol">{</a><a id="4398" href="exploration.html#4398" class="Bound">n</a><a id="4399" class="Symbol">}</a> <a id="4401" class="Symbol">→</a> <a id="4403" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4405" class="Symbol">→</a> <a id="4407" href="exploration.html#4318" class="Datatype">Inst</a> <a id="4412" href="exploration.html#4398" class="Bound">n</a> <a id="4414" class="Symbol">(</a><a id="4415" class="Number">1</a> <a id="4417" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4419" href="exploration.html#4398" class="Bound">n</a><a id="4420" class="Symbol">)</a>

  <a id="4425" class="Keyword">data</a> <a id="StackEval.IList"></a><a id="4430" href="exploration.html#4430" class="Datatype">IList</a> <a id="4436" class="Symbol">:</a> <a id="4438" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4440" class="Symbol">→</a> <a id="4442" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4444" class="Symbol">→</a> <a id="4446" href="Agda.Primitive.html#326" class="Primitive">Type₀</a> <a id="4452" class="Keyword">where</a>
    <a id="StackEval.IList.[]"></a><a id="4462" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="4465" class="Symbol">:</a> <a id="4467" class="Symbol">∀</a> <a id="4469" class="Symbol">{</a><a id="4470" href="exploration.html#4470" class="Bound">i</a><a id="4471" class="Symbol">}</a> <a id="4473" class="Symbol">→</a> <a id="4475" href="exploration.html#4430" class="Datatype">IList</a> <a id="4481" href="exploration.html#4470" class="Bound">i</a> <a id="4483" href="exploration.html#4470" class="Bound">i</a>
    <a id="StackEval.IList._∷_"></a><a id="4489" href="exploration.html#4489" class="InductiveConstructor Operator">_∷_</a> <a id="4493" class="Symbol">:</a> <a id="4495" class="Symbol">∀</a> <a id="4497" class="Symbol">{</a><a id="4498" href="exploration.html#4498" class="Bound">i</a> <a id="4500" href="exploration.html#4500" class="Bound">j</a> <a id="4502" href="exploration.html#4502" class="Bound">k</a><a id="4503" class="Symbol">}</a> <a id="4505" class="Symbol">→</a> <a id="4507" href="exploration.html#4318" class="Datatype">Inst</a> <a id="4512" href="exploration.html#4498" class="Bound">i</a> <a id="4514" href="exploration.html#4500" class="Bound">j</a> <a id="4516" class="Symbol">→</a> <a id="4518" href="exploration.html#4430" class="Datatype">IList</a> <a id="4524" href="exploration.html#4500" class="Bound">j</a> <a id="4526" href="exploration.html#4502" class="Bound">k</a> <a id="4528" class="Symbol">→</a> <a id="4530" href="exploration.html#4430" class="Datatype">IList</a> <a id="4536" href="exploration.html#4498" class="Bound">i</a> <a id="4538" href="exploration.html#4502" class="Bound">k</a>
  
  <a id="StackEval.[_]"></a><a id="4545" href="exploration.html#4545" class="Function Operator">[_]</a> <a id="4549" class="Symbol">:</a> <a id="4551" class="Symbol">∀</a> <a id="4553" class="Symbol">{</a><a id="4554" href="exploration.html#4554" class="Bound">i</a> <a id="4556" href="exploration.html#4556" class="Bound">j</a><a id="4557" class="Symbol">}</a> <a id="4559" class="Symbol">→</a> <a id="4561" href="exploration.html#4318" class="Datatype">Inst</a> <a id="4566" href="exploration.html#4554" class="Bound">i</a> <a id="4568" href="exploration.html#4556" class="Bound">j</a> <a id="4570" class="Symbol">→</a> <a id="4572" href="exploration.html#4430" class="Datatype">IList</a> <a id="4578" href="exploration.html#4554" class="Bound">i</a> <a id="4580" href="exploration.html#4556" class="Bound">j</a>
  <a id="4584" href="exploration.html#4545" class="Function Operator">[</a> <a id="4586" href="exploration.html#4586" class="Bound">x</a> <a id="4588" href="exploration.html#4545" class="Function Operator">]</a> <a id="4590" class="Symbol">=</a> <a id="4592" href="exploration.html#4586" class="Bound">x</a> <a id="4594" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4596" href="exploration.html#4462" class="InductiveConstructor">[]</a>

  <a id="4602" class="Keyword">infixr</a> <a id="4609" class="Number">5</a> <a id="4611" href="exploration.html#4619" class="Function Operator">_+++_</a>
  <a id="StackEval._+++_"></a><a id="4619" href="exploration.html#4619" class="Function Operator">_+++_</a> <a id="4625" class="Symbol">:</a> <a id="4627" class="Symbol">∀</a> <a id="4629" class="Symbol">{</a><a id="4630" href="exploration.html#4630" class="Bound">i</a> <a id="4632" href="exploration.html#4632" class="Bound">j</a> <a id="4634" href="exploration.html#4634" class="Bound">k</a><a id="4635" class="Symbol">}</a> <a id="4637" class="Symbol">→</a> <a id="4639" href="exploration.html#4430" class="Datatype">IList</a> <a id="4645" href="exploration.html#4630" class="Bound">i</a> <a id="4647" href="exploration.html#4632" class="Bound">j</a> <a id="4649" class="Symbol">→</a> <a id="4651" href="exploration.html#4430" class="Datatype">IList</a> <a id="4657" href="exploration.html#4632" class="Bound">j</a> <a id="4659" href="exploration.html#4634" class="Bound">k</a> <a id="4661" class="Symbol">→</a> <a id="4663" href="exploration.html#4430" class="Datatype">IList</a> <a id="4669" href="exploration.html#4630" class="Bound">i</a> <a id="4671" href="exploration.html#4634" class="Bound">k</a>
  <a id="4675" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="4678" href="exploration.html#4619" class="Function Operator">+++</a> <a id="4682" href="exploration.html#4682" class="Bound">ys</a> <a id="4685" class="Symbol">=</a> <a id="4687" href="exploration.html#4682" class="Bound">ys</a>
  <a id="4692" class="Symbol">(</a><a id="4693" href="exploration.html#4693" class="Bound">x</a> <a id="4695" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4697" href="exploration.html#4697" class="Bound">xs</a><a id="4699" class="Symbol">)</a> <a id="4701" href="exploration.html#4619" class="Function Operator">+++</a> <a id="4705" href="exploration.html#4705" class="Bound">ys</a> <a id="4708" class="Symbol">=</a> <a id="4710" href="exploration.html#4693" class="Bound">x</a> <a id="4712" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4714" class="Symbol">(</a><a id="4715" href="exploration.html#4697" class="Bound">xs</a> <a id="4718" href="exploration.html#4619" class="Function Operator">+++</a> <a id="4722" href="exploration.html#4705" class="Bound">ys</a><a id="4724" class="Symbol">)</a>

  <a id="StackEval.↑_"></a><a id="4729" href="exploration.html#4729" class="Function Operator">↑_</a> <a id="4732" class="Symbol">:</a> <a id="4734" class="Symbol">∀</a> <a id="4736" class="Symbol">{</a><a id="4737" href="exploration.html#4737" class="Bound">i</a> <a id="4739" href="exploration.html#4739" class="Bound">j</a><a id="4740" class="Symbol">}</a> <a id="4742" class="Symbol">→</a> <a id="4744" href="exploration.html#4430" class="Datatype">IList</a> <a id="4750" href="exploration.html#4737" class="Bound">i</a> <a id="4752" href="exploration.html#4739" class="Bound">j</a> <a id="4754" class="Symbol">→</a> <a id="4756" href="exploration.html#4430" class="Datatype">IList</a> <a id="4762" class="Symbol">(</a><a id="4763" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4767" href="exploration.html#4737" class="Bound">i</a><a id="4768" class="Symbol">)</a> <a id="4770" class="Symbol">(</a><a id="4771" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4775" href="exploration.html#4739" class="Bound">j</a><a id="4776" class="Symbol">)</a> 
  <a id="4781" href="exploration.html#4729" class="Function Operator">↑</a> <a id="4783" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="4786" class="Symbol">=</a> <a id="4788" href="exploration.html#4462" class="InductiveConstructor">[]</a>
  <a id="4793" href="exploration.html#4729" class="Function Operator">↑</a> <a id="4795" class="Symbol">(</a><a id="4796" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="4800" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4802" href="exploration.html#4802" class="Bound">xs</a><a id="4804" class="Symbol">)</a> <a id="4806" class="Symbol">=</a> <a id="4808" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="4812" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4814" class="Symbol">(</a><a id="4815" href="exploration.html#4729" class="Function Operator">↑</a> <a id="4817" href="exploration.html#4802" class="Bound">xs</a><a id="4819" class="Symbol">)</a>
  <a id="4823" href="exploration.html#4729" class="Function Operator">↑</a> <a id="4825" class="Symbol">(</a><a id="4826" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="4831" href="exploration.html#4831" class="Bound">x</a> <a id="4833" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4835" href="exploration.html#4835" class="Bound">xs</a><a id="4837" class="Symbol">)</a> <a id="4839" class="Symbol">=</a> <a id="4841" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="4846" href="exploration.html#4831" class="Bound">x</a> <a id="4848" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4850" class="Symbol">(</a><a id="4851" href="exploration.html#4729" class="Function Operator">↑</a> <a id="4853" href="exploration.html#4835" class="Bound">xs</a><a id="4855" class="Symbol">)</a>

  <a id="StackEval.eval"></a><a id="4860" href="exploration.html#4860" class="Function">eval</a> <a id="4865" class="Symbol">:</a> <a id="4867" href="exploration.html#4430" class="Datatype">IList</a> <a id="4873" href="exploration.html#394" class="Generalizable">n</a> <a id="4875" href="exploration.html#396" class="Generalizable">m</a> <a id="4877" class="Symbol">→</a> <a id="4879" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="4883" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4885" href="exploration.html#394" class="Generalizable">n</a> <a id="4887" class="Symbol">→</a> <a id="4889" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="4893" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4895" href="exploration.html#396" class="Generalizable">m</a>
  <a id="4899" href="exploration.html#4860" class="Function">eval</a> <a id="4904" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="4907" href="exploration.html#4907" class="Bound">stack</a> <a id="4913" class="Symbol">=</a> <a id="4915" href="exploration.html#4907" class="Bound">stack</a>
  <a id="4923" href="exploration.html#4860" class="Function">eval</a> <a id="4928" class="Symbol">(</a><a id="4929" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="4933" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4935" href="exploration.html#4935" class="Bound">xs</a><a id="4937" class="Symbol">)</a> <a id="4939" class="Symbol">(</a><a id="4940" href="exploration.html#4940" class="Bound">x</a> <a id="4942" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="4944" href="exploration.html#4944" class="Bound">y</a> <a id="4946" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="4948" href="exploration.html#4948" class="Bound">stack</a><a id="4953" class="Symbol">)</a> <a id="4955" class="Symbol">=</a> <a id="4957" href="exploration.html#4860" class="Function">eval</a> <a id="4962" href="exploration.html#4935" class="Bound">xs</a> <a id="4965" class="Symbol">(</a><a id="4966" href="exploration.html#4940" class="Bound">x</a> <a id="4968" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4970" href="exploration.html#4944" class="Bound">y</a> <a id="4972" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="4974" href="exploration.html#4948" class="Bound">stack</a><a id="4979" class="Symbol">)</a>
  <a id="4983" href="exploration.html#4860" class="Function">eval</a> <a id="4988" class="Symbol">(</a><a id="4989" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="4994" href="exploration.html#4994" class="Bound">x</a> <a id="4996" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="4998" href="exploration.html#4998" class="Bound">xs</a><a id="5000" class="Symbol">)</a> <a id="5002" href="exploration.html#5002" class="Bound">stack</a> <a id="5008" class="Symbol">=</a> <a id="5010" href="exploration.html#4860" class="Function">eval</a> <a id="5015" href="exploration.html#4998" class="Bound">xs</a> <a id="5018" class="Symbol">(</a><a id="5019" href="exploration.html#4994" class="Bound">x</a> <a id="5021" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5023" href="exploration.html#5002" class="Bound">stack</a><a id="5028" class="Symbol">)</a>

  <a id="StackEval.run-eval"></a><a id="5033" href="exploration.html#5033" class="Function">run-eval</a> <a id="5042" class="Symbol">:</a> <a id="5044" class="Symbol">(</a><a id="5045" href="exploration.html#5045" class="Bound">xs</a> <a id="5048" class="Symbol">:</a> <a id="5050" href="exploration.html#4430" class="Datatype">IList</a> <a id="5056" href="exploration.html#394" class="Generalizable">n</a> <a id="5058" href="exploration.html#396" class="Generalizable">m</a><a id="5059" class="Symbol">)</a> <a id="5061" class="Symbol">(</a><a id="5062" href="exploration.html#5062" class="Bound">stack</a> <a id="5068" class="Symbol">:</a> <a id="5070" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="5074" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="5076" href="exploration.html#394" class="Generalizable">n</a><a id="5077" class="Symbol">)</a> <a id="5079" class="Symbol">→</a> <a id="5081" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="5083" class="Symbol">(</a><a id="5084" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="5088" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="5090" href="exploration.html#396" class="Generalizable">m</a><a id="5091" class="Symbol">)</a> <a id="5093" class="Symbol">(</a><a id="5094" href="exploration.html#4860" class="Function">eval</a> <a id="5099" href="exploration.html#5045" class="Bound">xs</a> <a id="5102" href="exploration.html#5062" class="Bound">stack</a> <a id="5108" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡_</a><a id="5110" class="Symbol">)</a>
  <a id="5114" href="exploration.html#5033" class="Function">run-eval</a> <a id="5123" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="5126" href="exploration.html#5126" class="Bound">stack</a> <a id="5132" class="Symbol">=</a> <a id="5134" href="exploration.html#5126" class="Bound">stack</a> <a id="5140" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5142" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
  <a id="5149" href="exploration.html#5033" class="Function">run-eval</a> <a id="5158" class="Symbol">(</a><a id="5159" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="5163" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5165" href="exploration.html#5165" class="Bound">xs</a><a id="5167" class="Symbol">)</a> <a id="5169" class="Symbol">(</a><a id="5170" href="exploration.html#5170" class="Bound">x</a> <a id="5172" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5174" href="exploration.html#5174" class="Bound">y</a> <a id="5176" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5178" href="exploration.html#5178" class="Bound">stack</a><a id="5183" class="Symbol">)</a> <a id="5185" class="Symbol">=</a> <a id="5187" href="exploration.html#5033" class="Function">run-eval</a> <a id="5196" href="exploration.html#5165" class="Bound">xs</a> <a id="5199" class="Symbol">(</a><a id="5200" href="exploration.html#5170" class="Bound">x</a> <a id="5202" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5204" href="exploration.html#5174" class="Bound">y</a> <a id="5206" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5208" href="exploration.html#5178" class="Bound">stack</a><a id="5213" class="Symbol">)</a>
  <a id="5217" href="exploration.html#5033" class="Function">run-eval</a> <a id="5226" class="Symbol">(</a><a id="5227" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="5232" href="exploration.html#5232" class="Bound">x</a> <a id="5234" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5236" href="exploration.html#5236" class="Bound">xs</a><a id="5238" class="Symbol">)</a> <a id="5240" href="exploration.html#5240" class="Bound">stack</a> <a id="5246" class="Symbol">=</a> <a id="5248" href="exploration.html#5033" class="Function">run-eval</a> <a id="5257" href="exploration.html#5236" class="Bound">xs</a> <a id="5260" class="Symbol">(</a><a id="5261" href="exploration.html#5232" class="Bound">x</a> <a id="5263" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5265" href="exploration.html#5240" class="Bound">stack</a><a id="5270" class="Symbol">)</a>
<a id="5272" class="Markup">```
</a><a id="5276" class="Background">
And some simple properties of the above definitions

</a><a id="5330" class="Markup">```
</a>  <a id="StackEval.↑eval"></a><a id="5336" href="exploration.html#5336" class="Function">↑eval</a> <a id="5342" class="Symbol">:</a> <a id="5344" class="Symbol">∀</a> <a id="5346" class="Symbol">(</a><a id="5347" href="exploration.html#5347" class="Bound">xs</a> <a id="5350" class="Symbol">:</a> <a id="5352" href="exploration.html#4430" class="Datatype">IList</a> <a id="5358" href="exploration.html#394" class="Generalizable">n</a> <a id="5360" href="exploration.html#396" class="Generalizable">m</a><a id="5361" class="Symbol">)</a> <a id="5363" class="Symbol">(</a><a id="5364" href="exploration.html#5364" class="Bound">stack</a> <a id="5370" class="Symbol">:</a> <a id="5372" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="5376" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="5378" href="exploration.html#394" class="Generalizable">n</a><a id="5379" class="Symbol">)</a> <a id="5381" class="Symbol">(</a><a id="5382" href="exploration.html#5382" class="Bound">x</a> <a id="5384" class="Symbol">:</a> <a id="5386" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5387" class="Symbol">)</a> <a id="5389" class="Symbol">→</a> <a id="5391" href="exploration.html#4860" class="Function">eval</a> <a id="5396" href="exploration.html#5347" class="Bound">xs</a> <a id="5399" href="exploration.html#5364" class="Bound">stack</a> <a id="5405" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="5408" href="exploration.html#5382" class="Bound">x</a>  <a id="5411" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5413" href="exploration.html#4860" class="Function">eval</a> <a id="5418" class="Symbol">(</a><a id="5419" href="exploration.html#4729" class="Function Operator">↑</a> <a id="5421" href="exploration.html#5347" class="Bound">xs</a><a id="5423" class="Symbol">)</a> <a id="5425" class="Symbol">(</a><a id="5426" href="exploration.html#5364" class="Bound">stack</a> <a id="5432" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="5435" href="exploration.html#5382" class="Bound">x</a><a id="5436" class="Symbol">)</a>
  <a id="5440" href="exploration.html#5336" class="Function">↑eval</a> <a id="5446" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="5449" href="exploration.html#5449" class="Bound">stack</a> <a id="5455" href="exploration.html#5455" class="Bound">x</a> <a id="5457" class="Symbol">=</a> <a id="5459" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
  <a id="5466" href="exploration.html#5336" class="Function">↑eval</a> <a id="5472" class="Symbol">(</a><a id="5473" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="5477" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5479" href="exploration.html#5479" class="Bound">xs</a><a id="5481" class="Symbol">)</a> <a id="5483" class="Symbol">(</a><a id="5484" href="exploration.html#5484" class="Bound">y</a> <a id="5486" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5488" href="exploration.html#5488" class="Bound">z</a> <a id="5490" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5492" href="exploration.html#5492" class="Bound">stack</a><a id="5497" class="Symbol">)</a> <a id="5499" href="exploration.html#5499" class="Bound">x</a> <a id="5501" class="Symbol">=</a> <a id="5503" href="exploration.html#5336" class="Function">↑eval</a> <a id="5509" href="exploration.html#5479" class="Bound">xs</a> <a id="5512" class="Symbol">(</a><a id="5513" href="exploration.html#5484" class="Bound">y</a> <a id="5515" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5517" href="exploration.html#5488" class="Bound">z</a> <a id="5519" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5521" href="exploration.html#5492" class="Bound">stack</a><a id="5526" class="Symbol">)</a> <a id="5528" href="exploration.html#5499" class="Bound">x</a>
  <a id="5532" href="exploration.html#5336" class="Function">↑eval</a> <a id="5538" class="Symbol">(</a><a id="5539" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="5544" href="exploration.html#5544" class="Bound">y</a> <a id="5546" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5548" href="exploration.html#5548" class="Bound">xs</a><a id="5550" class="Symbol">)</a> <a id="5552" href="exploration.html#5552" class="Bound">stack</a> <a id="5558" href="exploration.html#5558" class="Bound">x</a> <a id="5560" class="Symbol">=</a> <a id="5562" href="exploration.html#5336" class="Function">↑eval</a> <a id="5568" href="exploration.html#5548" class="Bound">xs</a> <a id="5571" class="Symbol">(</a><a id="5572" href="exploration.html#5544" class="Bound">y</a> <a id="5574" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5576" href="exploration.html#5552" class="Bound">stack</a><a id="5581" class="Symbol">)</a> <a id="5583" href="exploration.html#5558" class="Bound">x</a>

  <a id="StackEval.eval-+++⁻"></a><a id="5588" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5598" class="Symbol">:</a> <a id="5600" class="Symbol">∀</a> <a id="5602" class="Symbol">{</a><a id="5603" href="exploration.html#5603" class="Bound">i</a> <a id="5605" href="exploration.html#5605" class="Bound">j</a> <a id="5607" href="exploration.html#5607" class="Bound">k</a><a id="5608" class="Symbol">}</a> <a id="5610" class="Symbol">(</a><a id="5611" href="exploration.html#5611" class="Bound">is</a> <a id="5614" class="Symbol">:</a> <a id="5616" href="exploration.html#4430" class="Datatype">IList</a> <a id="5622" href="exploration.html#5603" class="Bound">i</a> <a id="5624" href="exploration.html#5605" class="Bound">j</a><a id="5625" class="Symbol">)</a> <a id="5627" class="Symbol">(</a><a id="5628" href="exploration.html#5628" class="Bound">js</a> <a id="5631" class="Symbol">:</a> <a id="5633" href="exploration.html#4430" class="Datatype">IList</a> <a id="5639" href="exploration.html#5605" class="Bound">j</a> <a id="5641" href="exploration.html#5607" class="Bound">k</a><a id="5642" class="Symbol">)</a> <a id="5644" class="Symbol">(</a><a id="5645" href="exploration.html#5645" class="Bound">stack</a> <a id="5651" class="Symbol">:</a> <a id="5653" href="Cubical.Data.Vec.Base.html#328" class="Datatype">Vec</a> <a id="5657" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="5659" href="exploration.html#5603" class="Bound">i</a><a id="5660" class="Symbol">)</a> 
            <a id="5675" class="Symbol">→</a> <a id="5677" href="exploration.html#4860" class="Function">eval</a> <a id="5682" class="Symbol">(</a><a id="5683" href="exploration.html#5611" class="Bound">is</a> <a id="5686" href="exploration.html#4619" class="Function Operator">+++</a> <a id="5690" href="exploration.html#5628" class="Bound">js</a><a id="5692" class="Symbol">)</a> <a id="5694" href="exploration.html#5645" class="Bound">stack</a> <a id="5700" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5702" href="exploration.html#4860" class="Function">eval</a> <a id="5707" href="exploration.html#5628" class="Bound">js</a> <a id="5710" class="Symbol">(</a><a id="5711" href="exploration.html#4860" class="Function">eval</a> <a id="5716" href="exploration.html#5611" class="Bound">is</a> <a id="5719" href="exploration.html#5645" class="Bound">stack</a><a id="5724" class="Symbol">)</a>
  <a id="5728" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5738" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="5741" href="exploration.html#5741" class="Bound">js</a> <a id="5744" href="exploration.html#5744" class="Bound">stack</a> <a id="5750" class="Symbol">=</a> <a id="5752" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
  <a id="5759" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5769" class="Symbol">(</a><a id="5770" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="5774" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5776" href="exploration.html#5776" class="Bound">is</a><a id="5778" class="Symbol">)</a> <a id="5780" href="exploration.html#5780" class="Bound">js</a> <a id="5783" class="Symbol">(</a><a id="5784" href="exploration.html#5784" class="Bound">x</a> <a id="5786" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5788" href="exploration.html#5788" class="Bound">y</a> <a id="5790" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5792" href="exploration.html#5792" class="Bound">stack</a><a id="5797" class="Symbol">)</a> <a id="5799" class="Symbol">=</a> <a id="5801" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5811" href="exploration.html#5776" class="Bound">is</a> <a id="5814" href="exploration.html#5780" class="Bound">js</a> <a id="5817" class="Symbol">(</a><a id="5818" href="exploration.html#5784" class="Bound">x</a> <a id="5820" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5822" href="exploration.html#5788" class="Bound">y</a> <a id="5824" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5826" href="exploration.html#5792" class="Bound">stack</a><a id="5831" class="Symbol">)</a>
  <a id="5835" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5845" class="Symbol">(</a><a id="5846" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="5851" href="exploration.html#5851" class="Bound">x</a> <a id="5853" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="5855" href="exploration.html#5855" class="Bound">is</a><a id="5857" class="Symbol">)</a> <a id="5859" href="exploration.html#5859" class="Bound">js</a> <a id="5862" href="exploration.html#5862" class="Bound">stack</a> <a id="5868" class="Symbol">=</a> <a id="5870" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="5880" href="exploration.html#5855" class="Bound">is</a> <a id="5883" href="exploration.html#5859" class="Bound">js</a> <a id="5886" class="Symbol">(</a><a id="5887" href="exploration.html#5851" class="Bound">x</a> <a id="5889" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="5891" href="exploration.html#5862" class="Bound">stack</a><a id="5896" class="Symbol">)</a>

  <a id="StackEval.eval-+++ˡ"></a><a id="5901" href="exploration.html#5901" class="Function">eval-+++ˡ</a> <a id="5911" class="Symbol">:</a> <a id="5913" class="Symbol">∀</a> <a id="5915" class="Symbol">{</a><a id="5916" href="exploration.html#5916" class="Bound">i</a> <a id="5918" href="exploration.html#5918" class="Bound">j</a> <a id="5920" href="exploration.html#5920" class="Bound">k</a><a id="5921" class="Symbol">}</a> <a id="5923" class="Symbol">(</a><a id="5924" href="exploration.html#5924" class="Bound">is</a> <a id="5927" href="exploration.html#5927" class="Bound">js</a> <a id="5930" class="Symbol">:</a> <a id="5932" href="exploration.html#4430" class="Datatype">IList</a> <a id="5938" href="exploration.html#5916" class="Bound">i</a> <a id="5940" href="exploration.html#5918" class="Bound">j</a><a id="5941" class="Symbol">)</a> <a id="5943" class="Symbol">(</a><a id="5944" href="exploration.html#5944" class="Bound">ks</a> <a id="5947" class="Symbol">:</a> <a id="5949" href="exploration.html#4430" class="Datatype">IList</a> <a id="5955" href="exploration.html#5918" class="Bound">j</a> <a id="5957" href="exploration.html#5920" class="Bound">k</a><a id="5958" class="Symbol">)</a> <a id="5960" href="exploration.html#5960" class="Bound">stack</a> 
            <a id="5979" class="Symbol">→</a> <a id="5981" href="exploration.html#4860" class="Function">eval</a> <a id="5986" href="exploration.html#5924" class="Bound">is</a> <a id="5989" href="exploration.html#5960" class="Bound">stack</a> <a id="5995" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5997" href="exploration.html#4860" class="Function">eval</a> <a id="6002" href="exploration.html#5927" class="Bound">js</a> <a id="6005" href="exploration.html#5960" class="Bound">stack</a> 
            <a id="6024" class="Symbol">→</a> <a id="6026" href="exploration.html#4860" class="Function">eval</a> <a id="6031" class="Symbol">(</a><a id="6032" href="exploration.html#5924" class="Bound">is</a> <a id="6035" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6039" href="exploration.html#5944" class="Bound">ks</a><a id="6041" class="Symbol">)</a> <a id="6043" href="exploration.html#5960" class="Bound">stack</a> <a id="6049" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="6051" href="exploration.html#4860" class="Function">eval</a> <a id="6056" class="Symbol">(</a><a id="6057" href="exploration.html#5927" class="Bound">js</a> <a id="6060" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6064" href="exploration.html#5944" class="Bound">ks</a><a id="6066" class="Symbol">)</a> <a id="6068" href="exploration.html#5960" class="Bound">stack</a>
  <a id="6076" href="exploration.html#5901" class="Function">eval-+++ˡ</a> <a id="6086" href="exploration.html#6086" class="Bound">is</a> <a id="6089" href="exploration.html#6089" class="Bound">js</a> <a id="6092" href="exploration.html#6092" class="Bound">ks</a> <a id="6095" href="exploration.html#6095" class="Bound">stack</a> <a id="6101" href="exploration.html#6101" class="Bound">is≡js</a> <a id="6107" class="Symbol">=</a> 
    <a id="6114" href="exploration.html#4860" class="Function">eval</a> <a id="6119" class="Symbol">(</a><a id="6120" href="exploration.html#6086" class="Bound">is</a> <a id="6123" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6127" href="exploration.html#6092" class="Bound">ks</a><a id="6129" class="Symbol">)</a> <a id="6131" href="exploration.html#6095" class="Bound">stack</a>   <a id="6139" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6142" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="6152" href="exploration.html#6086" class="Bound">is</a> <a id="6155" href="exploration.html#6092" class="Bound">ks</a> <a id="6158" href="exploration.html#6095" class="Bound">stack</a> <a id="6164" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
    <a id="6170" href="exploration.html#4860" class="Function">eval</a> <a id="6175" href="exploration.html#6092" class="Bound">ks</a> <a id="6178" class="Symbol">(</a><a id="6179" href="exploration.html#4860" class="Function">eval</a> <a id="6184" href="exploration.html#6086" class="Bound">is</a> <a id="6187" href="exploration.html#6095" class="Bound">stack</a><a id="6192" class="Symbol">)</a>  <a id="6195" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6198" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="6203" class="Symbol">(</a><a id="6204" href="exploration.html#4860" class="Function">eval</a> <a id="6209" href="exploration.html#6092" class="Bound">ks</a><a id="6211" class="Symbol">)</a> <a id="6213" href="exploration.html#6101" class="Bound">is≡js</a> <a id="6219" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
    <a id="6225" href="exploration.html#4860" class="Function">eval</a> <a id="6230" href="exploration.html#6092" class="Bound">ks</a> <a id="6233" class="Symbol">(</a><a id="6234" href="exploration.html#4860" class="Function">eval</a> <a id="6239" href="exploration.html#6089" class="Bound">js</a> <a id="6242" href="exploration.html#6095" class="Bound">stack</a><a id="6247" class="Symbol">)</a>  <a id="6250" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6253" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="6257" class="Symbol">(</a><a id="6258" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="6268" href="exploration.html#6089" class="Bound">js</a> <a id="6271" href="exploration.html#6092" class="Bound">ks</a> <a id="6274" href="exploration.html#6095" class="Bound">stack</a><a id="6279" class="Symbol">)</a> <a id="6281" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a> 
    <a id="6288" href="exploration.html#4860" class="Function">eval</a> <a id="6293" class="Symbol">(</a><a id="6294" href="exploration.html#6089" class="Bound">js</a> <a id="6297" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6301" href="exploration.html#6092" class="Bound">ks</a><a id="6303" class="Symbol">)</a> <a id="6305" href="exploration.html#6095" class="Bound">stack</a>   <a id="6313" href="Cubical.Foundations.Prelude.html#6931" class="Function Operator">∎</a>

  <a id="StackEval.eval-+++ʳ"></a><a id="6318" href="exploration.html#6318" class="Function">eval-+++ʳ</a> <a id="6328" class="Symbol">:</a> <a id="6330" class="Symbol">∀</a> <a id="6332" class="Symbol">{</a><a id="6333" href="exploration.html#6333" class="Bound">i</a> <a id="6335" href="exploration.html#6335" class="Bound">j</a> <a id="6337" href="exploration.html#6337" class="Bound">k</a><a id="6338" class="Symbol">}</a> <a id="6340" class="Symbol">(</a><a id="6341" href="exploration.html#6341" class="Bound">is</a> <a id="6344" class="Symbol">:</a> <a id="6346" href="exploration.html#4430" class="Datatype">IList</a> <a id="6352" href="exploration.html#6333" class="Bound">i</a> <a id="6354" href="exploration.html#6335" class="Bound">j</a><a id="6355" class="Symbol">)</a> <a id="6357" class="Symbol">(</a><a id="6358" href="exploration.html#6358" class="Bound">js</a> <a id="6361" href="exploration.html#6361" class="Bound">ks</a> <a id="6364" class="Symbol">:</a> <a id="6366" href="exploration.html#4430" class="Datatype">IList</a> <a id="6372" href="exploration.html#6335" class="Bound">j</a> <a id="6374" href="exploration.html#6337" class="Bound">k</a><a id="6375" class="Symbol">)</a> <a id="6377" href="exploration.html#6377" class="Bound">stack</a> 
            <a id="6396" class="Symbol">→</a> <a id="6398" href="exploration.html#4860" class="Function">eval</a> <a id="6403" href="exploration.html#6358" class="Bound">js</a> <a id="6406" class="Symbol">(</a><a id="6407" href="exploration.html#4860" class="Function">eval</a> <a id="6412" href="exploration.html#6341" class="Bound">is</a> <a id="6415" href="exploration.html#6377" class="Bound">stack</a><a id="6420" class="Symbol">)</a> <a id="6422" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="6424" href="exploration.html#4860" class="Function">eval</a> <a id="6429" href="exploration.html#6361" class="Bound">ks</a> <a id="6432" class="Symbol">(</a><a id="6433" href="exploration.html#4860" class="Function">eval</a> <a id="6438" href="exploration.html#6341" class="Bound">is</a> <a id="6441" href="exploration.html#6377" class="Bound">stack</a><a id="6446" class="Symbol">)</a> 
            <a id="6461" class="Symbol">→</a> <a id="6463" href="exploration.html#4860" class="Function">eval</a> <a id="6468" class="Symbol">(</a><a id="6469" href="exploration.html#6341" class="Bound">is</a> <a id="6472" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6476" href="exploration.html#6358" class="Bound">js</a><a id="6478" class="Symbol">)</a> <a id="6480" href="exploration.html#6377" class="Bound">stack</a> <a id="6486" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="6488" href="exploration.html#4860" class="Function">eval</a> <a id="6493" class="Symbol">(</a><a id="6494" href="exploration.html#6341" class="Bound">is</a> <a id="6497" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6501" href="exploration.html#6361" class="Bound">ks</a><a id="6503" class="Symbol">)</a> <a id="6505" href="exploration.html#6377" class="Bound">stack</a>
  <a id="6513" href="exploration.html#6318" class="Function">eval-+++ʳ</a> <a id="6523" href="exploration.html#6523" class="Bound">is</a> <a id="6526" href="exploration.html#6526" class="Bound">js</a> <a id="6529" href="exploration.html#6529" class="Bound">ks</a> <a id="6532" href="exploration.html#6532" class="Bound">stack</a> <a id="6538" href="exploration.html#6538" class="Bound">js≡ks</a> <a id="6544" class="Symbol">=</a>
    <a id="6550" href="exploration.html#4860" class="Function">eval</a> <a id="6555" class="Symbol">(</a><a id="6556" href="exploration.html#6523" class="Bound">is</a> <a id="6559" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6563" href="exploration.html#6526" class="Bound">js</a><a id="6565" class="Symbol">)</a> <a id="6567" href="exploration.html#6532" class="Bound">stack</a>   <a id="6575" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6578" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="6588" href="exploration.html#6523" class="Bound">is</a> <a id="6591" href="exploration.html#6526" class="Bound">js</a> <a id="6594" href="exploration.html#6532" class="Bound">stack</a> <a id="6600" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
    <a id="6606" href="exploration.html#4860" class="Function">eval</a> <a id="6611" href="exploration.html#6526" class="Bound">js</a> <a id="6614" class="Symbol">(</a><a id="6615" href="exploration.html#4860" class="Function">eval</a> <a id="6620" href="exploration.html#6523" class="Bound">is</a> <a id="6623" href="exploration.html#6532" class="Bound">stack</a><a id="6628" class="Symbol">)</a>  <a id="6631" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6634" href="exploration.html#6538" class="Bound">js≡ks</a> <a id="6640" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
    <a id="6646" href="exploration.html#4860" class="Function">eval</a> <a id="6651" href="exploration.html#6529" class="Bound">ks</a> <a id="6654" class="Symbol">(</a><a id="6655" href="exploration.html#4860" class="Function">eval</a> <a id="6660" href="exploration.html#6523" class="Bound">is</a> <a id="6663" href="exploration.html#6532" class="Bound">stack</a><a id="6668" class="Symbol">)</a>  <a id="6671" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="6674" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="6678" class="Symbol">(</a><a id="6679" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="6689" href="exploration.html#6523" class="Bound">is</a> <a id="6692" href="exploration.html#6529" class="Bound">ks</a> <a id="6695" href="exploration.html#6532" class="Bound">stack</a><a id="6700" class="Symbol">)</a> <a id="6702" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
    <a id="6708" href="exploration.html#4860" class="Function">eval</a> <a id="6713" class="Symbol">(</a><a id="6714" href="exploration.html#6523" class="Bound">is</a> <a id="6717" href="exploration.html#4619" class="Function Operator">+++</a> <a id="6721" href="exploration.html#6529" class="Bound">ks</a><a id="6723" class="Symbol">)</a> <a id="6725" href="exploration.html#6532" class="Bound">stack</a>   <a id="6733" href="Cubical.Foundations.Prelude.html#6931" class="Function Operator">∎</a>
<a id="6735" class="Markup">```
</a><a id="6739" class="Background">
Now that we have predictable stack behaviour we can define the equivalence relation to quotient the lists. We only need to consider programs of type `IList 0 1`, i.e. programs that take no input and produce a stack with 1 output, since:

- _Base case:_ `compile (val x) = [ push x ]` which is an IList 0 1
- _Inductive case:_ `compile (add xs ys) = xs +++ (↑ ys) +++ [ add ]`, xs and ys are IList 0 1 by induction and the concatination is IList 0 1

Thus we can now define `IList/~ₑ` which are `Ilist 0 1` quotiented on equivalence of evaluation.

</a><a id="7288" class="Markup">```
</a>  <a id="StackEval.IList/~ₑ"></a><a id="7294" href="exploration.html#7294" class="Function">IList/~ₑ</a> <a id="7303" class="Symbol">:</a> <a id="7305" href="Agda.Primitive.html#326" class="Primitive">Type₀</a>
  <a id="7313" href="exploration.html#7294" class="Function">IList/~ₑ</a> <a id="7322" class="Symbol">=</a> <a id="7324" href="exploration.html#4430" class="Datatype">IList</a> <a id="7330" class="Number">0</a> <a id="7332" class="Number">1</a> <a id="7334" href="Cubical.HITs.SetQuotients.Base.html#215" class="Datatype Operator">/</a> <a id="7336" class="Symbol">λ</a> <a id="7338" href="exploration.html#7338" class="Bound">is</a> <a id="7341" href="exploration.html#7341" class="Bound">js</a> <a id="7344" class="Symbol">→</a> <a id="7346" class="Symbol">(</a><a id="7347" href="exploration.html#4860" class="Function">eval</a> <a id="7352" href="exploration.html#7338" class="Bound">is</a> <a id="7355" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="7358" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="7360" href="exploration.html#4860" class="Function">eval</a> <a id="7365" href="exploration.html#7341" class="Bound">js</a> <a id="7368" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="7370" class="Symbol">)</a>
<a id="7372" class="Markup">```
</a><a id="7376" class="Background">
Finally we can define `op`, here we have 2 proof obligations:

- we can substitute the left hand side of op with an equivalent program (and the result is equivalent) 
- the same for the rhs.

</a><a id="7569" class="Markup">```
</a>  <a id="StackEval.op"></a><a id="7575" href="exploration.html#7575" class="Function">op</a> <a id="7578" class="Symbol">:</a> <a id="7580" href="exploration.html#7294" class="Function">IList/~ₑ</a> <a id="7589" class="Symbol">→</a> <a id="7591" href="exploration.html#7294" class="Function">IList/~ₑ</a> <a id="7600" class="Symbol">→</a> <a id="7602" href="exploration.html#7294" class="Function">IList/~ₑ</a>
  <a id="7613" href="exploration.html#7575" class="Function">op</a> <a id="7616" class="Symbol">=</a> <a id="7618" href="Cubical.HITs.SetQuotients.Properties.html#3485" class="Function">rec2</a> <a id="7623" href="Cubical.HITs.SetQuotients.Base.html#361" class="InductiveConstructor">squash/</a> <a id="7631" class="Symbol">(λ</a> <a id="7634" href="exploration.html#7634" class="Bound">a</a> <a id="7636" href="exploration.html#7636" class="Bound">b</a> <a id="7638" class="Symbol">→</a> <a id="7640" href="exploration.html#289" class="InductiveConstructor Operator">[[</a> <a id="7643" href="exploration.html#7634" class="Bound">a</a> <a id="7645" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7649" href="exploration.html#4729" class="Function Operator">↑</a> <a id="7651" href="exploration.html#7636" class="Bound">b</a> <a id="7653" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7657" href="exploration.html#4545" class="Function Operator">[</a> <a id="7659" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="7663" href="exploration.html#4545" class="Function Operator">]</a> <a id="7665" href="exploration.html#289" class="InductiveConstructor Operator">]]</a><a id="7667" class="Symbol">)</a> 
    <a id="7674" class="Symbol">(λ</a> <a id="7677" href="exploration.html#7677" class="Bound">a</a> <a id="7679" href="exploration.html#7679" class="Bound">b</a> <a id="7681" href="exploration.html#7681" class="Bound">c</a> <a id="7683" href="exploration.html#7683" class="Bound">r</a> <a id="7685" class="Symbol">→</a> <a id="7687" href="Cubical.HITs.SetQuotients.Base.html#313" class="InductiveConstructor">eq/</a> <a id="7691" class="Symbol">_</a> <a id="7693" class="Symbol">_</a> <a id="7695" class="Symbol">(</a><a id="7696" href="exploration.html#5901" class="Function">eval-+++ˡ</a> <a id="7706" href="exploration.html#7677" class="Bound">a</a> <a id="7708" href="exploration.html#7679" class="Bound">b</a> <a id="7710" class="Symbol">(</a><a id="7711" href="exploration.html#4729" class="Function Operator">↑</a> <a id="7713" href="exploration.html#7681" class="Bound">c</a> <a id="7715" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7719" href="exploration.html#4545" class="Function Operator">[</a> <a id="7721" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="7725" href="exploration.html#4545" class="Function Operator">]</a><a id="7726" class="Symbol">)</a> <a id="7728" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="7731" href="exploration.html#7683" class="Bound">r</a><a id="7732" class="Symbol">))</a>
    <a id="7739" class="Symbol">λ</a> <a id="7741" href="exploration.html#7741" class="Bound">a</a> <a id="7743" href="exploration.html#7743" class="Bound">b</a> <a id="7745" href="exploration.html#7745" class="Bound">c</a> <a id="7747" href="exploration.html#7747" class="Bound">r</a>  <a id="7750" class="Symbol">→</a> <a id="7752" href="Cubical.HITs.SetQuotients.Base.html#313" class="InductiveConstructor">eq/</a> <a id="7756" class="Symbol">_</a> <a id="7758" class="Symbol">_</a> <a id="7760" class="Symbol">(</a><a id="7761" href="exploration.html#7788" class="Function">aux</a> <a id="7765" href="exploration.html#7741" class="Bound">a</a> <a id="7767" href="exploration.html#7743" class="Bound">b</a> <a id="7769" href="exploration.html#7745" class="Bound">c</a> <a id="7771" href="exploration.html#7747" class="Bound">r</a><a id="7772" class="Symbol">)</a>
    <a id="7778" class="Keyword">where</a>
    <a id="7788" href="exploration.html#7788" class="Function">aux</a> <a id="7792" class="Symbol">:</a> <a id="7794" class="Symbol">(</a><a id="7795" href="exploration.html#7795" class="Bound">a</a> <a id="7797" href="exploration.html#7797" class="Bound">b</a> <a id="7799" href="exploration.html#7799" class="Bound">c</a> <a id="7801" class="Symbol">:</a> <a id="7803" href="exploration.html#4430" class="Datatype">IList</a> <a id="7809" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="7814" class="Number">1</a><a id="7815" class="Symbol">)</a>
      <a id="7823" class="Symbol">(</a><a id="7824" href="exploration.html#7824" class="Bound">r</a> <a id="7826" class="Symbol">:</a> <a id="7828" href="exploration.html#4860" class="Function">eval</a> <a id="7833" href="exploration.html#7797" class="Bound">b</a> <a id="7835" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="7838" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="7840" href="exploration.html#4860" class="Function">eval</a> <a id="7845" href="exploration.html#7799" class="Bound">c</a> <a id="7847" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="7849" class="Symbol">)</a> <a id="7851" class="Symbol">→</a>
      <a id="7859" href="exploration.html#4860" class="Function">eval</a> <a id="7864" class="Symbol">(</a><a id="7865" href="exploration.html#7795" class="Bound">a</a> <a id="7867" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7871" href="exploration.html#4729" class="Function Operator">↑</a> <a id="7873" href="exploration.html#7797" class="Bound">b</a> <a id="7875" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7879" class="Symbol">(</a><a id="7880" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="7884" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="7886" href="exploration.html#4462" class="InductiveConstructor">[]</a><a id="7888" class="Symbol">))</a> <a id="7891" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="7894" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a>
      <a id="7902" href="exploration.html#4860" class="Function">eval</a> <a id="7907" class="Symbol">(</a><a id="7908" href="exploration.html#7795" class="Bound">a</a> <a id="7910" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7914" class="Symbol">((</a><a id="7916" href="exploration.html#4729" class="Function Operator">↑</a> <a id="7918" href="exploration.html#7799" class="Bound">c</a><a id="7919" class="Symbol">)</a> <a id="7921" href="exploration.html#4619" class="Function Operator">+++</a> <a id="7925" class="Symbol">(</a><a id="7926" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="7930" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="7932" href="exploration.html#4462" class="InductiveConstructor">[]</a><a id="7934" class="Symbol">)))</a> <a id="7938" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>
    <a id="7945" href="exploration.html#7788" class="Function">aux</a> <a id="7949" href="exploration.html#7949" class="Bound">a</a> <a id="7951" href="exploration.html#7951" class="Bound">b</a> <a id="7953" href="exploration.html#7953" class="Bound">c</a> <a id="7955" href="exploration.html#7955" class="Bound">r</a> <a id="7957" class="Keyword">with</a> <a id="7962" href="exploration.html#5033" class="Function">run-eval</a> <a id="7971" href="exploration.html#7949" class="Bound">a</a> <a id="7973" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> 
    <a id="7981" class="Symbol">...</a> <a id="7985" class="Symbol">|</a> <a id="7987" href="exploration.html#7987" class="Bound">x</a> <a id="7989" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="7991" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="7994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7996" href="exploration.html#7996" class="Bound">evala</a> <a id="8002" class="Symbol">=</a> 
        <a id="8013" href="exploration.html#6318" class="Function">eval-+++ʳ</a> <a id="8023" class="Bound">a</a> <a id="8025" class="Symbol">(</a><a id="8026" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8028" class="Bound">b</a> <a id="8030" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8034" href="exploration.html#4545" class="Function Operator">[</a> <a id="8036" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="8040" href="exploration.html#4545" class="Function Operator">]</a><a id="8041" class="Symbol">)</a> <a id="8043" class="Symbol">(</a><a id="8044" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8046" class="Bound">c</a> <a id="8048" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8052" href="exploration.html#4545" class="Function Operator">[</a> <a id="8054" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="8058" href="exploration.html#4545" class="Function Operator">]</a><a id="8059" class="Symbol">)</a> <a id="8061" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8064" href="Cubical.Reflection.Base.html#338" class="Function Operator">$</a> 
        <a id="8075" href="exploration.html#5901" class="Function">eval-+++ˡ</a> <a id="8085" class="Symbol">(</a><a id="8086" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8088" class="Bound">b</a><a id="8089" class="Symbol">)</a> <a id="8091" class="Symbol">(</a><a id="8092" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8094" class="Bound">c</a><a id="8095" class="Symbol">)</a> <a id="8097" href="exploration.html#4545" class="Function Operator">[</a> <a id="8099" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="8103" href="exploration.html#4545" class="Function Operator">]</a> <a id="8105" class="Symbol">(</a><a id="8106" href="exploration.html#4860" class="Function">eval</a> <a id="8111" class="Bound">a</a> <a id="8113" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="8115" class="Symbol">)</a> <a id="8117" class="Symbol">(</a> 
          <a id="8130" href="exploration.html#4860" class="Function">eval</a> <a id="8135" class="Symbol">(</a><a id="8136" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8138" class="Bound">b</a><a id="8139" class="Symbol">)</a> <a id="8141" class="Symbol">(</a><a id="8142" href="exploration.html#4860" class="Function">eval</a> <a id="8147" class="Bound">a</a> <a id="8149" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="8151" class="Symbol">)</a>  <a id="8154" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="8157" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="8162" class="Symbol">(</a><a id="8163" href="exploration.html#4860" class="Function">eval</a> <a id="8168" class="Symbol">(</a><a id="8169" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8171" class="Bound">b</a><a id="8172" class="Symbol">))</a> <a id="8175" href="exploration.html#7996" class="Bound">evala</a> <a id="8181" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
          <a id="8193" href="exploration.html#4860" class="Function">eval</a> <a id="8198" class="Symbol">(</a><a id="8199" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8201" class="Bound">b</a><a id="8202" class="Symbol">)</a> <a id="8204" class="Symbol">(</a><a id="8205" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8208" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="8211" href="exploration.html#7987" class="Bound">x</a><a id="8212" class="Symbol">)</a>    <a id="8217" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="8220" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="8224" class="Symbol">(</a><a id="8225" href="exploration.html#5336" class="Function">↑eval</a> <a id="8231" class="Bound">b</a> <a id="8233" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8236" href="exploration.html#7987" class="Bound">x</a><a id="8237" class="Symbol">)</a> <a id="8239" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
          <a id="8251" href="exploration.html#4860" class="Function">eval</a> <a id="8256" class="Bound">b</a> <a id="8258" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8261" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="8264" href="exploration.html#7987" class="Bound">x</a>          <a id="8275" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="8278" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="8283" class="Symbol">(</a><a id="8284" href="exploration.html#532" class="Function Operator">_∷ʳ</a> <a id="8288" href="exploration.html#7987" class="Bound">x</a><a id="8289" class="Symbol">)</a> <a id="8291" class="Bound">r</a> <a id="8293" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>  
          <a id="8307" href="exploration.html#4860" class="Function">eval</a> <a id="8312" class="Bound">c</a> <a id="8314" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8317" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="8320" href="exploration.html#7987" class="Bound">x</a>          <a id="8331" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="8334" href="exploration.html#5336" class="Function">↑eval</a> <a id="8340" class="Bound">c</a> <a id="8342" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8345" href="exploration.html#7987" class="Bound">x</a> <a id="8347" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
          <a id="8359" href="exploration.html#4860" class="Function">eval</a> <a id="8364" class="Symbol">(</a><a id="8365" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8367" class="Bound">c</a><a id="8368" class="Symbol">)</a> <a id="8370" class="Symbol">(</a><a id="8371" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8374" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="8377" href="exploration.html#7987" class="Bound">x</a><a id="8378" class="Symbol">)</a>    <a id="8383" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="8386" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="8391" class="Symbol">(</a><a id="8392" href="exploration.html#4860" class="Function">eval</a> <a id="8397" class="Symbol">(</a><a id="8398" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8400" class="Bound">c</a><a id="8401" class="Symbol">))</a> <a id="8404" class="Symbol">(</a><a id="8405" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="8409" href="exploration.html#7996" class="Bound">evala</a><a id="8414" class="Symbol">)</a> <a id="8416" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
          <a id="8428" href="exploration.html#4860" class="Function">eval</a> <a id="8433" class="Symbol">(</a><a id="8434" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8436" class="Bound">c</a><a id="8437" class="Symbol">)</a> <a id="8439" class="Symbol">(</a><a id="8440" href="exploration.html#4860" class="Function">eval</a> <a id="8445" class="Bound">a</a> <a id="8447" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="8449" class="Symbol">)</a>  <a id="8452" href="Cubical.Foundations.Prelude.html#6931" class="Function Operator">∎</a> <a id="8454" class="Symbol">)</a>
<a id="8456" class="Markup">```
</a><a id="8460" class="Background">
Now with how this is setup, the proof is as follows:

1. `eval (xs +++ ys +++ add) []`
2. `eval (ys +++ add) [x]`
3. `eval add [y, x]`
4. `[y + x]`

Then by commutativity of addition we get `[x + y]` and can work our way back up to `eval (ys +++ xs +++ add) []`, thus proving the associativity of `op`.

</a><a id="8765" class="Markup">```
</a>  <a id="StackEval.op-comm"></a><a id="8771" href="exploration.html#8771" class="Function">op-comm</a> <a id="8779" class="Symbol">:</a> <a id="8781" class="Symbol">∀</a> <a id="8783" class="Symbol">(</a><a id="8784" href="exploration.html#8784" class="Bound">xs</a> <a id="8787" href="exploration.html#8787" class="Bound">ys</a> <a id="8790" class="Symbol">:</a> <a id="8792" href="exploration.html#7294" class="Function">IList/~ₑ</a><a id="8800" class="Symbol">)</a> <a id="8802" class="Symbol">→</a> <a id="8804" href="exploration.html#7575" class="Function">op</a> <a id="8807" href="exploration.html#8784" class="Bound">xs</a> <a id="8810" href="exploration.html#8787" class="Bound">ys</a> <a id="8813" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="8815" href="exploration.html#7575" class="Function">op</a> <a id="8818" href="exploration.html#8787" class="Bound">ys</a> <a id="8821" href="exploration.html#8784" class="Bound">xs</a>
  <a id="8826" href="exploration.html#8771" class="Function">op-comm</a> <a id="8834" class="Symbol">=</a> <a id="8836" href="Cubical.HITs.SetQuotients.Properties.html#1558" class="Function">elimProp2</a> <a id="8846" class="Symbol">(λ</a> <a id="8849" href="exploration.html#8849" class="Bound">x</a> <a id="8851" href="exploration.html#8851" class="Bound">y</a> <a id="8853" class="Symbol">→</a> <a id="8855" href="Cubical.HITs.SetQuotients.Base.html#361" class="InductiveConstructor">squash/</a> <a id="8863" class="Symbol">_</a> <a id="8865" class="Symbol">_)</a> <a id="8868" class="Symbol">λ</a> <a id="8870" href="exploration.html#8870" class="Bound">a</a> <a id="8872" href="exploration.html#8872" class="Bound">b</a> <a id="8874" class="Symbol">→</a> <a id="8876" href="Cubical.HITs.SetQuotients.Base.html#313" class="InductiveConstructor">eq/</a> <a id="8880" class="Symbol">_</a> <a id="8882" class="Symbol">_</a> <a id="8884" class="Symbol">(</a><a id="8885" href="exploration.html#8910" class="Function">lemma</a> <a id="8891" href="exploration.html#8870" class="Bound">a</a> <a id="8893" href="exploration.html#8872" class="Bound">b</a><a id="8894" class="Symbol">)</a>
    <a id="8900" class="Keyword">where</a>
    <a id="8910" href="exploration.html#8910" class="Function">lemma</a> <a id="8916" class="Symbol">:</a> <a id="8918" class="Symbol">(</a><a id="8919" href="exploration.html#8919" class="Bound">a</a> <a id="8921" href="exploration.html#8921" class="Bound">b</a> <a id="8923" class="Symbol">:</a> <a id="8925" href="exploration.html#4430" class="Datatype">IList</a> <a id="8931" class="Number">0</a> <a id="8933" class="Number">1</a><a id="8934" class="Symbol">)</a> <a id="8936" class="Symbol">→</a> <a id="8938" href="exploration.html#4860" class="Function">eval</a> <a id="8943" class="Symbol">(</a><a id="8944" href="exploration.html#8919" class="Bound">a</a> <a id="8946" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8950" class="Symbol">(</a><a id="8951" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8953" href="exploration.html#8921" class="Bound">b</a><a id="8954" class="Symbol">)</a> <a id="8956" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8960" href="exploration.html#4545" class="Function Operator">[</a> <a id="8962" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="8966" href="exploration.html#4545" class="Function Operator">]</a><a id="8967" class="Symbol">)</a> <a id="8969" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="8972" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="8974" href="exploration.html#4860" class="Function">eval</a> <a id="8979" class="Symbol">(</a><a id="8980" href="exploration.html#8921" class="Bound">b</a> <a id="8982" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8986" class="Symbol">(</a><a id="8987" href="exploration.html#4729" class="Function Operator">↑</a> <a id="8989" href="exploration.html#8919" class="Bound">a</a><a id="8990" class="Symbol">)</a> <a id="8992" href="exploration.html#4619" class="Function Operator">+++</a> <a id="8996" href="exploration.html#4545" class="Function Operator">[</a> <a id="8998" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9002" href="exploration.html#4545" class="Function Operator">]</a><a id="9003" class="Symbol">)</a> <a id="9005" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>
    <a id="9012" href="exploration.html#8910" class="Function">lemma</a> <a id="9018" href="exploration.html#9018" class="Bound">a</a> <a id="9020" href="exploration.html#9020" class="Bound">b</a> <a id="9022" class="Keyword">with</a> <a id="9027" href="exploration.html#5033" class="Function">run-eval</a> <a id="9036" href="exploration.html#9018" class="Bound">a</a> <a id="9038" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9041" class="Symbol">|</a> <a id="9043" href="exploration.html#5033" class="Function">run-eval</a> <a id="9052" href="exploration.html#9020" class="Bound">b</a> <a id="9054" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>
    <a id="9061" class="Symbol">...</a> <a id="9065" class="Symbol">|</a> <a id="9067" href="exploration.html#9067" class="Bound">x</a> <a id="9069" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9071" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9074" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9076" href="exploration.html#9076" class="Bound">evala</a> <a id="9082" class="Symbol">|</a> <a id="9084" href="exploration.html#9084" class="Bound">y</a> <a id="9086" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9088" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9091" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9093" href="exploration.html#9093" class="Bound">evalb</a> <a id="9099" class="Symbol">=</a> 
      <a id="9108" href="exploration.html#4860" class="Function">eval</a> <a id="9113" class="Symbol">(</a><a id="9114" class="Bound">a</a> <a id="9116" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9120" class="Symbol">(</a><a id="9121" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9123" class="Bound">b</a><a id="9124" class="Symbol">)</a> <a id="9126" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9130" href="exploration.html#4545" class="Function Operator">[</a> <a id="9132" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9136" href="exploration.html#4545" class="Function Operator">]</a><a id="9137" class="Symbol">)</a> <a id="9139" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>     <a id="9146" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9149" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="9159" class="Bound">a</a> <a id="9161" class="Symbol">(</a><a id="9162" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9164" class="Bound">b</a> <a id="9166" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9170" href="exploration.html#4545" class="Function Operator">[</a> <a id="9172" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9176" href="exploration.html#4545" class="Function Operator">]</a><a id="9177" class="Symbol">)</a> <a id="9179" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9182" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9190" href="exploration.html#4860" class="Function">eval</a> <a id="9195" class="Symbol">((</a><a id="9197" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9199" class="Bound">b</a><a id="9200" class="Symbol">)</a> <a id="9202" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9206" href="exploration.html#4545" class="Function Operator">[</a> <a id="9208" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9212" href="exploration.html#4545" class="Function Operator">]</a><a id="9213" class="Symbol">)</a> <a id="9215" class="Symbol">(</a><a id="9216" href="exploration.html#4860" class="Function">eval</a> <a id="9221" class="Bound">a</a> <a id="9223" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="9225" class="Symbol">)</a>  <a id="9228" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9231" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9236" class="Symbol">(</a><a id="9237" href="exploration.html#4860" class="Function">eval</a> <a id="9242" class="Symbol">((</a><a id="9244" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9246" class="Bound">b</a><a id="9247" class="Symbol">)</a> <a id="9249" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9253" href="exploration.html#4545" class="Function Operator">[</a> <a id="9255" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9259" href="exploration.html#4545" class="Function Operator">]</a><a id="9260" class="Symbol">))</a> <a id="9263" href="exploration.html#9076" class="Bound">evala</a> <a id="9269" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9277" href="exploration.html#4860" class="Function">eval</a> <a id="9282" class="Symbol">((</a><a id="9284" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9286" class="Bound">b</a><a id="9287" class="Symbol">)</a> <a id="9289" href="exploration.html#4619" class="Function Operator">+++</a> <a id="9293" href="exploration.html#4545" class="Function Operator">[</a> <a id="9295" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9299" href="exploration.html#4545" class="Function Operator">]</a><a id="9300" class="Symbol">)</a> <a id="9302" class="Symbol">(</a><a id="9303" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9306" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9309" href="exploration.html#9067" class="Bound">x</a><a id="9310" class="Symbol">)</a>    <a id="9315" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9318" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="9328" class="Symbol">(</a><a id="9329" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9331" class="Bound">b</a><a id="9332" class="Symbol">)</a> <a id="9334" href="exploration.html#4545" class="Function Operator">[</a> <a id="9336" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9340" href="exploration.html#4545" class="Function Operator">]</a> <a id="9342" class="Symbol">(</a><a id="9343" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9346" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9349" href="exploration.html#9067" class="Bound">x</a><a id="9350" class="Symbol">)</a> <a id="9352" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9360" href="exploration.html#4860" class="Function">eval</a> <a id="9365" href="exploration.html#4545" class="Function Operator">[</a> <a id="9367" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9371" href="exploration.html#4545" class="Function Operator">]</a> <a id="9373" class="Symbol">(</a><a id="9374" href="exploration.html#4860" class="Function">eval</a> <a id="9379" class="Symbol">(</a><a id="9380" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9382" class="Bound">b</a><a id="9383" class="Symbol">)</a> <a id="9385" class="Symbol">(</a><a id="9386" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9389" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9392" href="exploration.html#9067" class="Bound">x</a><a id="9393" class="Symbol">))</a>   <a id="9398" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9401" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9406" class="Symbol">(</a><a id="9407" href="exploration.html#4860" class="Function">eval</a> <a id="9412" href="exploration.html#4545" class="Function Operator">[</a> <a id="9414" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9418" href="exploration.html#4545" class="Function Operator">]</a><a id="9419" class="Symbol">)</a> <a id="9421" class="Symbol">(</a><a id="9422" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="9426" class="Symbol">(</a><a id="9427" href="exploration.html#5336" class="Function">↑eval</a> <a id="9433" class="Bound">b</a> <a id="9435" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9438" href="exploration.html#9067" class="Bound">x</a><a id="9439" class="Symbol">))</a> <a id="9442" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9450" href="exploration.html#4860" class="Function">eval</a> <a id="9455" href="exploration.html#4545" class="Function Operator">[</a> <a id="9457" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9461" href="exploration.html#4545" class="Function Operator">]</a> <a id="9463" class="Symbol">(</a><a id="9464" href="exploration.html#4860" class="Function">eval</a> <a id="9469" class="Bound">b</a> <a id="9471" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9474" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9477" href="exploration.html#9067" class="Bound">x</a><a id="9478" class="Symbol">)</a>         <a id="9488" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9491" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9496" class="Symbol">(λ</a> <a id="9499" href="exploration.html#9499" class="Bound">z</a> <a id="9501" class="Symbol">→</a> <a id="9503" href="exploration.html#4860" class="Function">eval</a> <a id="9508" href="exploration.html#4545" class="Function Operator">[</a> <a id="9510" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9514" href="exploration.html#4545" class="Function Operator">]</a> <a id="9516" class="Symbol">(</a><a id="9517" href="exploration.html#9499" class="Bound">z</a> <a id="9519" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9522" href="exploration.html#9067" class="Bound">x</a><a id="9523" class="Symbol">))</a> <a id="9526" href="exploration.html#9093" class="Bound">evalb</a> <a id="9532" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9540" href="exploration.html#4860" class="Function">eval</a> <a id="9545" href="exploration.html#4545" class="Function Operator">[</a> <a id="9547" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9551" href="exploration.html#4545" class="Function Operator">]</a> <a id="9553" class="Symbol">(</a><a id="9554" href="exploration.html#9084" class="Bound">y</a> <a id="9556" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9558" href="exploration.html#9067" class="Bound">x</a> <a id="9560" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9562" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="9564" class="Symbol">)</a>             <a id="9578" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9581" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a> <a id="9586" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9594" href="exploration.html#9084" class="Bound">y</a> <a id="9596" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9598" href="exploration.html#9067" class="Bound">x</a> <a id="9600" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9602" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>                            <a id="9632" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9635" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9640" class="Symbol">(</a><a id="9641" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">_∷</a> <a id="9644" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="9646" class="Symbol">)</a> <a id="9648" class="Symbol">(</a><a id="9649" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="9656" href="exploration.html#9084" class="Bound">y</a> <a id="9658" href="exploration.html#9067" class="Bound">x</a><a id="9659" class="Symbol">)</a> <a id="9661" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9669" href="exploration.html#9067" class="Bound">x</a> <a id="9671" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="9673" href="exploration.html#9084" class="Bound">y</a> <a id="9675" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9677" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>                            <a id="9707" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9710" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a> <a id="9715" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9723" href="exploration.html#4860" class="Function">eval</a> <a id="9728" href="exploration.html#4545" class="Function Operator">[</a> <a id="9730" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9734" href="exploration.html#4545" class="Function Operator">]</a> <a id="9736" class="Symbol">((</a><a id="9738" href="exploration.html#9067" class="Bound">x</a> <a id="9740" href="Cubical.Data.Vec.Base.html#385" class="InductiveConstructor Operator">∷</a> <a id="9742" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="9744" class="Symbol">)</a> <a id="9746" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9749" href="exploration.html#9084" class="Bound">y</a><a id="9750" class="Symbol">)</a>          <a id="9761" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9764" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9769" class="Symbol">(λ</a> <a id="9772" href="exploration.html#9772" class="Bound">z</a> <a id="9774" class="Symbol">→</a> <a id="9776" href="exploration.html#4860" class="Function">eval</a> <a id="9781" href="exploration.html#4545" class="Function Operator">[</a> <a id="9783" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9787" href="exploration.html#4545" class="Function Operator">]</a> <a id="9789" class="Symbol">(</a><a id="9790" href="exploration.html#9772" class="Bound">z</a> <a id="9792" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9795" href="exploration.html#9084" class="Bound">y</a><a id="9796" class="Symbol">))</a> <a id="9799" class="Symbol">(</a><a id="9800" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="9804" href="exploration.html#9076" class="Bound">evala</a><a id="9809" class="Symbol">)</a> <a id="9811" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9819" href="exploration.html#4860" class="Function">eval</a> <a id="9824" href="exploration.html#4545" class="Function Operator">[</a> <a id="9826" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9830" href="exploration.html#4545" class="Function Operator">]</a> <a id="9832" class="Symbol">(</a><a id="9833" href="exploration.html#4860" class="Function">eval</a> <a id="9838" class="Bound">a</a> <a id="9840" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9843" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9846" href="exploration.html#9084" class="Bound">y</a><a id="9847" class="Symbol">)</a>         <a id="9857" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9860" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="9865" class="Symbol">(</a><a id="9866" href="exploration.html#4860" class="Function">eval</a> <a id="9871" href="exploration.html#4545" class="Function Operator">[</a> <a id="9873" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9877" href="exploration.html#4545" class="Function Operator">]</a><a id="9878" class="Symbol">)</a> <a id="9880" class="Symbol">(</a><a id="9881" href="exploration.html#5336" class="Function">↑eval</a> <a id="9887" class="Bound">a</a> <a id="9889" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9892" href="exploration.html#9084" class="Bound">y</a><a id="9893" class="Symbol">)</a> <a id="9895" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9903" href="exploration.html#4860" class="Function">eval</a> <a id="9908" href="exploration.html#4545" class="Function Operator">[</a> <a id="9910" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9914" href="exploration.html#4545" class="Function Operator">]</a> <a id="9916" class="Symbol">(</a><a id="9917" href="exploration.html#4860" class="Function">eval</a> <a id="9922" class="Symbol">(</a><a id="9923" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9925" class="Bound">a</a><a id="9926" class="Symbol">)</a> <a id="9928" class="Symbol">(</a><a id="9929" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9932" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9935" href="exploration.html#9084" class="Bound">y</a><a id="9936" class="Symbol">))</a>   <a id="9941" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="9944" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="9948" class="Symbol">(</a><a id="9949" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="9959" class="Symbol">(</a><a id="9960" href="exploration.html#4729" class="Function Operator">↑</a> <a id="9962" class="Bound">a</a><a id="9963" class="Symbol">)</a> <a id="9965" href="exploration.html#4545" class="Function Operator">[</a> <a id="9967" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="9971" href="exploration.html#4545" class="Function Operator">]</a> <a id="9973" class="Symbol">(</a><a id="9974" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="9977" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="9980" href="exploration.html#9084" class="Bound">y</a><a id="9981" class="Symbol">))</a> <a id="9984" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="9992" href="exploration.html#4860" class="Function">eval</a> <a id="9997" class="Symbol">((</a><a id="9999" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10001" class="Bound">a</a><a id="10002" class="Symbol">)</a> <a id="10004" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10008" href="exploration.html#4545" class="Function Operator">[</a> <a id="10010" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10014" href="exploration.html#4545" class="Function Operator">]</a><a id="10015" class="Symbol">)</a> <a id="10017" class="Symbol">(</a><a id="10018" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a> <a id="10021" href="exploration.html#532" class="Function Operator">∷ʳ</a> <a id="10024" href="exploration.html#9084" class="Bound">y</a><a id="10025" class="Symbol">)</a>    <a id="10030" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="10033" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="10038" class="Symbol">(</a><a id="10039" href="exploration.html#4860" class="Function">eval</a> <a id="10044" class="Symbol">((</a><a id="10046" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10048" class="Bound">a</a><a id="10049" class="Symbol">)</a> <a id="10051" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10055" href="exploration.html#4545" class="Function Operator">[</a> <a id="10057" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10061" href="exploration.html#4545" class="Function Operator">]</a><a id="10062" class="Symbol">))</a> <a id="10065" class="Symbol">(</a><a id="10066" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="10070" href="exploration.html#9093" class="Bound">evalb</a><a id="10075" class="Symbol">)</a> <a id="10077" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="10085" href="exploration.html#4860" class="Function">eval</a> <a id="10090" class="Symbol">((</a><a id="10092" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10094" class="Bound">a</a><a id="10095" class="Symbol">)</a> <a id="10097" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10101" href="exploration.html#4545" class="Function Operator">[</a> <a id="10103" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10107" href="exploration.html#4545" class="Function Operator">]</a><a id="10108" class="Symbol">)</a> <a id="10110" class="Symbol">(</a><a id="10111" href="exploration.html#4860" class="Function">eval</a> <a id="10116" class="Bound">b</a> <a id="10118" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="10120" class="Symbol">)</a>  <a id="10123" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">≡⟨</a> <a id="10126" href="Cubical.Foundations.Prelude.html#927" class="Function">sym</a> <a id="10130" class="Symbol">(</a><a id="10131" href="exploration.html#5588" class="Function">eval-+++⁻</a> <a id="10141" class="Bound">b</a> <a id="10143" class="Symbol">(</a><a id="10144" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10146" class="Bound">a</a> <a id="10148" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10152" href="exploration.html#4545" class="Function Operator">[</a> <a id="10154" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10158" href="exploration.html#4545" class="Function Operator">]</a><a id="10159" class="Symbol">)</a> <a id="10161" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="10163" class="Symbol">)</a> <a id="10165" href="Cubical.Foundations.Prelude.html#6462" class="Function Operator">⟩</a>
      <a id="10173" href="exploration.html#4860" class="Function">eval</a> <a id="10178" class="Symbol">(</a><a id="10179" class="Bound">b</a> <a id="10181" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10185" class="Symbol">(</a><a id="10186" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10188" class="Bound">a</a><a id="10189" class="Symbol">)</a> <a id="10191" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10195" href="exploration.html#4545" class="Function Operator">[</a> <a id="10197" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10201" href="exploration.html#4545" class="Function Operator">]</a><a id="10202" class="Symbol">)</a> <a id="10204" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a>     <a id="10211" href="Cubical.Foundations.Prelude.html#6931" class="Function Operator">∎</a> 
<a id="10214" class="Markup">```
</a><a id="10218" class="Background">
And so, the definition of `compile` (and `eval&#39;`)

</a><a id="10270" class="Markup">```
</a>  <a id="StackEval.compile"></a><a id="10276" href="exploration.html#10276" class="Function">compile</a> <a id="10284" class="Symbol">:</a> <a id="10286" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="10293" class="Symbol">→</a> <a id="10295" href="exploration.html#7294" class="Function">IList/~ₑ</a>
  <a id="10306" href="exploration.html#10276" class="Function">compile</a> <a id="10314" class="Symbol">(</a><a id="10315" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="10319" href="exploration.html#10319" class="Bound">x</a><a id="10320" class="Symbol">)</a> <a id="10322" class="Symbol">=</a> <a id="10324" href="exploration.html#289" class="InductiveConstructor Operator">[[</a> <a id="10327" class="Symbol">(</a><a id="10328" href="exploration.html#4388" class="InductiveConstructor">push</a> <a id="10333" href="exploration.html#10319" class="Bound">x</a><a id="10334" class="Symbol">)</a> <a id="10336" href="exploration.html#4489" class="InductiveConstructor Operator">∷</a> <a id="10338" href="exploration.html#4462" class="InductiveConstructor">[]</a> <a id="10341" href="exploration.html#289" class="InductiveConstructor Operator">]]</a>
  <a id="10346" href="exploration.html#10276" class="Function">compile</a> <a id="10354" class="Symbol">(</a><a id="10355" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="10359" href="exploration.html#10359" class="Bound">t₁</a> <a id="10362" href="exploration.html#10362" class="Bound">t₂</a><a id="10364" class="Symbol">)</a> <a id="10366" class="Symbol">=</a> <a id="10368" href="exploration.html#7575" class="Function">op</a> <a id="10371" class="Symbol">(</a><a id="10372" href="exploration.html#10276" class="Function">compile</a> <a id="10380" href="exploration.html#10359" class="Bound">t₁</a><a id="10382" class="Symbol">)</a> <a id="10384" class="Symbol">(</a><a id="10385" href="exploration.html#10276" class="Function">compile</a> <a id="10393" href="exploration.html#10362" class="Bound">t₂</a><a id="10395" class="Symbol">)</a>
  <a id="10399" href="exploration.html#10276" class="Function">compile</a> <a id="10407" class="Symbol">(</a><a id="10408" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="10413" href="exploration.html#10413" class="Bound">t₁</a> <a id="10416" href="exploration.html#10416" class="Bound">t₂</a> <a id="10419" href="exploration.html#10419" class="Bound">i</a><a id="10420" class="Symbol">)</a> <a id="10422" class="Symbol">=</a> <a id="10424" href="exploration.html#8771" class="Function">op-comm</a> <a id="10432" class="Symbol">(</a><a id="10433" href="exploration.html#10276" class="Function">compile</a> <a id="10441" href="exploration.html#10413" class="Bound">t₁</a><a id="10443" class="Symbol">)</a> <a id="10445" class="Symbol">(</a><a id="10446" href="exploration.html#10276" class="Function">compile</a> <a id="10454" href="exploration.html#10416" class="Bound">t₂</a><a id="10456" class="Symbol">)</a> <a id="10458" href="exploration.html#10419" class="Bound">i</a>

  <a id="StackEval.eval&#39;"></a><a id="10463" href="exploration.html#10463" class="Function">eval&#39;</a> <a id="10469" class="Symbol">:</a> <a id="10471" href="exploration.html#7294" class="Function">IList/~ₑ</a> <a id="10480" class="Symbol">→</a> <a id="10482" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="10486" href="exploration.html#10463" class="Function">eval&#39;</a> <a id="10492" class="Symbol">=</a> <a id="10494" href="Cubical.HITs.SetQuotients.Properties.html#3179" class="Function">rec</a> <a id="10498" href="Cubical.Data.Nat.Properties.html#1358" class="Function">isSetℕ</a> <a id="10505" class="Symbol">(λ</a> <a id="10508" href="exploration.html#10508" class="Bound">x</a> <a id="10510" class="Symbol">→</a> <a id="10512" href="Cubical.Data.Vec.Base.html#509" class="Function">head</a> <a id="10517" class="Symbol">(</a><a id="10518" href="exploration.html#4860" class="Function">eval</a> <a id="10523" href="exploration.html#10508" class="Bound">x</a> <a id="10525" href="Cubical.Data.Vec.Base.html#366" class="InductiveConstructor">[]</a><a id="10527" class="Symbol">))</a> <a id="10530" class="Symbol">λ</a> <a id="10532" class="Symbol">{</a> <a id="10534" class="Symbol">_</a> <a id="10536" class="Symbol">_</a> <a id="10538" href="exploration.html#10538" class="Bound">r</a> <a id="10540" class="Symbol">→</a> <a id="10542" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="10547" href="Cubical.Data.Vec.Base.html#509" class="Function">head</a> <a id="10552" href="exploration.html#10538" class="Bound">r</a> <a id="10554" class="Symbol">}</a>

  <a id="10559" href="exploration.html#10559" class="Function">_</a> <a id="10561" class="Symbol">:</a> <a id="10563" href="exploration.html#10463" class="Function">eval&#39;</a> <a id="10569" class="Symbol">(</a><a id="10570" href="exploration.html#10276" class="Function">compile</a> <a id="10578" class="Symbol">(</a><a id="10579" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="10583" class="Symbol">(</a><a id="10584" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="10588" class="Number">3</a><a id="10589" class="Symbol">)</a> <a id="10591" class="Symbol">(</a><a id="10592" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="10596" class="Number">4</a><a id="10597" class="Symbol">)))</a> <a id="10601" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="10603" class="Number">7</a>
  <a id="10607" class="Symbol">_</a> <a id="10609" class="Symbol">=</a> <a id="10611" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
<a id="10616" class="Markup">```
</a><a id="10620" class="Background">
Prehaps I am missing something, but the other approaches we talked about on Tuesday obviously don&#39;t work. For example:

</a><a id="10741" class="Markup">```
</a>  <a id="StackEval.IList/~₊"></a><a id="10747" href="exploration.html#10747" class="Function">IList/~₊</a> <a id="10756" class="Symbol">:</a> <a id="10758" href="Agda.Primitive.html#326" class="Primitive">Type₀</a>
  <a id="10766" href="exploration.html#10747" class="Function">IList/~₊</a> <a id="10775" class="Symbol">=</a> <a id="10777" href="exploration.html#4430" class="Datatype">IList</a> <a id="10783" class="Number">0</a> <a id="10785" class="Number">1</a> <a id="10787" href="Cubical.HITs.SetQuotients.Base.html#215" class="Datatype Operator">/</a> <a id="10789" class="Symbol">λ</a> <a id="10791" href="exploration.html#10791" class="Bound">xs</a> <a id="10794" href="exploration.html#10794" class="Bound">ys</a> <a id="10797" class="Symbol">→</a> <a id="10799" class="Symbol">(</a><a id="10800" href="exploration.html#10791" class="Bound">xs</a> <a id="10803" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10807" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10809" href="exploration.html#10794" class="Bound">ys</a> <a id="10812" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10816" href="exploration.html#4545" class="Function Operator">[</a> <a id="10818" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10822" href="exploration.html#4545" class="Function Operator">]</a><a id="10823" class="Symbol">)</a> <a id="10825" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="10827" class="Symbol">(</a><a id="10828" href="exploration.html#10794" class="Bound">ys</a> <a id="10831" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10835" href="exploration.html#4729" class="Function Operator">↑</a> <a id="10837" href="exploration.html#10791" class="Bound">xs</a> <a id="10840" href="exploration.html#4619" class="Function Operator">+++</a> <a id="10844" href="exploration.html#4545" class="Function Operator">[</a> <a id="10846" href="exploration.html#4349" class="InductiveConstructor">add</a> <a id="10850" href="exploration.html#4545" class="Function Operator">]</a><a id="10851" class="Symbol">)</a>
<a id="10853" class="Markup">```
</a><a id="10857" class="Background">
If we try to define `op` on this, we have the following proof obligation which is obviously not provable.

```none
(a b c : IList 0 1) →
a +++ (↑ b) +++ [ add ] ≡ b +++ (↑ a) +++ [ add ] →
-------------------------------------------------------------
[[ a +++ (↑ c) +++ [ add ] ]] ≡ [[ b +++ (↑ c) +++ [ add ] ]]
```

## Operational semantics

</a><a id="11202" class="Markup">```
</a><a id="11206" class="Keyword">module</a> <a id="11213" href="exploration.html#11213" class="Module">_</a> <a id="11215" class="Keyword">where</a>

  <a id="11224" class="Keyword">open</a> <a id="11229" class="Keyword">import</a> <a id="11236" href="Cubical.HITs.FiniteMultiset.html" class="Module">Cubical.HITs.FiniteMultiset</a>
  <a id="11266" class="Keyword">open</a> <a id="11271" class="Keyword">import</a> <a id="11278" href="Cubical.Data.Sum.html" class="Module">Cubical.Data.Sum</a> <a id="11295" class="Keyword">using</a> <a id="11301" class="Symbol">(</a><a id="11302" href="Cubical.Data.Sum.Base.html#203" class="Datatype Operator">_⊎_</a><a id="11305" class="Symbol">;</a> <a id="11307" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a><a id="11310" class="Symbol">;</a> <a id="11312" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a><a id="11315" class="Symbol">)</a>
  <a id="11319" class="Keyword">open</a> <a id="11324" class="Keyword">import</a> <a id="11331" href="Cubical.Foundations.Equiv.html" class="Module">Cubical.Foundations.Equiv</a>
  <a id="11359" class="Keyword">open</a> <a id="11364" class="Keyword">import</a> <a id="11371" href="Cubical.Foundations.Isomorphism.html" class="Module">Cubical.Foundations.Isomorphism</a>
  <a id="11405" class="Keyword">open</a> <a id="11410" class="Keyword">import</a> <a id="11417" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>

  <a id="11439" href="exploration.html#11439" class="Function">map</a> <a id="11443" class="Symbol">:</a> <a id="11445" class="Symbol">(</a><a id="11446" href="exploration.html#375" class="Generalizable">A</a> <a id="11448" class="Symbol">→</a> <a id="11450" href="exploration.html#377" class="Generalizable">B</a><a id="11451" class="Symbol">)</a> <a id="11453" class="Symbol">→</a> <a id="11455" href="Cubical.HITs.FiniteMultiset.Base.html#259" class="Datatype">FMSet</a> <a id="11461" href="exploration.html#375" class="Generalizable">A</a> <a id="11463" class="Symbol">→</a> <a id="11465" href="Cubical.HITs.FiniteMultiset.Base.html#259" class="Datatype">FMSet</a> <a id="11471" href="exploration.html#377" class="Generalizable">B</a>
  <a id="11475" href="exploration.html#11439" class="Function">map</a> <a id="11479" href="exploration.html#11479" class="Bound">f</a> <a id="11481" href="Cubical.HITs.FiniteMultiset.Base.html#295" class="InductiveConstructor">[]</a> <a id="11484" class="Symbol">=</a> <a id="11486" href="Cubical.HITs.FiniteMultiset.Base.html#295" class="InductiveConstructor">[]</a>
  <a id="11491" href="exploration.html#11439" class="Function">map</a> <a id="11495" href="exploration.html#11495" class="Bound">f</a> <a id="11497" class="Symbol">(</a><a id="11498" href="exploration.html#11498" class="Bound">x</a> <a id="11500" href="Cubical.HITs.FiniteMultiset.Base.html#313" class="InductiveConstructor Operator">∷</a> <a id="11502" href="exploration.html#11502" class="Bound">xs</a><a id="11504" class="Symbol">)</a> <a id="11506" class="Symbol">=</a> <a id="11508" class="Symbol">(</a><a id="11509" href="exploration.html#11495" class="Bound">f</a> <a id="11511" href="exploration.html#11498" class="Bound">x</a><a id="11512" class="Symbol">)</a> <a id="11514" href="Cubical.HITs.FiniteMultiset.Base.html#313" class="InductiveConstructor Operator">∷</a> <a id="11516" class="Symbol">(</a><a id="11517" href="exploration.html#11439" class="Function">map</a> <a id="11521" href="exploration.html#11495" class="Bound">f</a> <a id="11523" href="exploration.html#11502" class="Bound">xs</a><a id="11525" class="Symbol">)</a>
  <a id="11529" href="exploration.html#11439" class="Function">map</a> <a id="11533" href="exploration.html#11533" class="Bound">f</a> <a id="11535" class="Symbol">(</a><a id="11536" href="Cubical.HITs.FiniteMultiset.Base.html#358" class="InductiveConstructor">comm</a> <a id="11541" href="exploration.html#11541" class="Bound">x</a> <a id="11543" href="exploration.html#11543" class="Bound">y</a> <a id="11545" href="exploration.html#11545" class="Bound">xs</a> <a id="11548" href="exploration.html#11548" class="Bound">i</a><a id="11549" class="Symbol">)</a> <a id="11551" class="Symbol">=</a> <a id="11553" href="Cubical.HITs.FiniteMultiset.Base.html#358" class="InductiveConstructor">comm</a> <a id="11558" class="Symbol">(</a><a id="11559" href="exploration.html#11533" class="Bound">f</a> <a id="11561" href="exploration.html#11541" class="Bound">x</a><a id="11562" class="Symbol">)</a> <a id="11564" class="Symbol">(</a><a id="11565" href="exploration.html#11533" class="Bound">f</a> <a id="11567" href="exploration.html#11543" class="Bound">y</a><a id="11568" class="Symbol">)</a> <a id="11570" class="Symbol">(</a><a id="11571" href="exploration.html#11439" class="Function">map</a> <a id="11575" href="exploration.html#11533" class="Bound">f</a> <a id="11577" href="exploration.html#11545" class="Bound">xs</a><a id="11579" class="Symbol">)</a> <a id="11581" href="exploration.html#11548" class="Bound">i</a>
  <a id="11585" href="exploration.html#11439" class="Function">map</a> <a id="11589" href="exploration.html#11589" class="Bound">f</a> <a id="11591" class="Symbol">(</a><a id="11592" href="Cubical.HITs.FiniteMultiset.Base.html#403" class="InductiveConstructor">trunc</a> <a id="11598" href="exploration.html#11598" class="Bound">xs</a> <a id="11601" href="exploration.html#11601" class="Bound">ys</a> <a id="11604" href="exploration.html#11604" class="Bound">x</a> <a id="11606" href="exploration.html#11606" class="Bound">y</a> <a id="11608" href="exploration.html#11608" class="Bound">i</a> <a id="11610" href="exploration.html#11610" class="Bound">j</a><a id="11611" class="Symbol">)</a> <a id="11613" class="Symbol">=</a> <a id="11615" href="Cubical.HITs.FiniteMultiset.Base.html#403" class="InductiveConstructor">trunc</a> <a id="11621" class="Symbol">(</a><a id="11622" href="exploration.html#11439" class="Function">map</a> <a id="11626" href="exploration.html#11589" class="Bound">f</a> <a id="11628" href="exploration.html#11598" class="Bound">xs</a><a id="11630" class="Symbol">)</a> <a id="11632" class="Symbol">(</a><a id="11633" href="exploration.html#11439" class="Function">map</a> <a id="11637" href="exploration.html#11589" class="Bound">f</a> <a id="11639" href="exploration.html#11601" class="Bound">ys</a><a id="11641" class="Symbol">)</a> <a id="11643" class="Symbol">(</a><a id="11644" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="11649" class="Symbol">(</a><a id="11650" href="exploration.html#11439" class="Function">map</a> <a id="11654" href="exploration.html#11589" class="Bound">f</a><a id="11655" class="Symbol">)</a> <a id="11657" href="exploration.html#11604" class="Bound">x</a><a id="11658" class="Symbol">)</a> <a id="11660" class="Symbol">(</a><a id="11661" href="Cubical.Foundations.Prelude.html#1110" class="Function">cong</a> <a id="11666" class="Symbol">(</a><a id="11667" href="exploration.html#11439" class="Function">map</a> <a id="11671" href="exploration.html#11589" class="Bound">f</a><a id="11672" class="Symbol">)</a> <a id="11674" href="exploration.html#11606" class="Bound">y</a><a id="11675" class="Symbol">)</a> <a id="11677" href="exploration.html#11608" class="Bound">i</a> <a id="11679" href="exploration.html#11610" class="Bound">j</a>
<a id="11681" class="Markup">```
</a><a id="11685" class="Background">
The original definition used overlapping pattern matching which made the proofs longer (if they where even possible), hence the auxilary function here. In this case we don&#39;t need any additional structure on the resulting data type, since each one is an equally valid transition step, hence finite multisets / bags.

</a><a id="12002" class="Markup">```
</a>  <a id="12008" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12015" class="Symbol">:</a> <a id="12017" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="12024" class="Symbol">→</a> <a id="12026" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="12028" href="Cubical.Data.Sum.Base.html#203" class="Datatype Operator">⊎</a> <a id="12030" href="Cubical.HITs.FiniteMultiset.Base.html#259" class="Datatype">FMSet</a> <a id="12036" href="exploration.html#1159" class="Datatype">Hutton</a>
  <a id="12045" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12052" class="Symbol">(</a><a id="12053" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12057" href="exploration.html#12057" class="Bound">x</a><a id="12058" class="Symbol">)</a> <a id="12060" class="Symbol">=</a> <a id="12062" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12066" href="exploration.html#12057" class="Bound">x</a>
  <a id="12070" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12077" class="Symbol">(</a><a id="12078" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="12082" href="exploration.html#12082" class="Bound">t₁</a> <a id="12085" href="exploration.html#12085" class="Bound">t₂</a><a id="12087" class="Symbol">)</a> <a id="12089" class="Keyword">with</a> <a id="12094" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12101" href="exploration.html#12082" class="Bound">t₁</a> <a id="12104" class="Symbol">|</a> <a id="12106" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12113" href="exploration.html#12085" class="Bound">t₂</a> 
  <a id="12119" class="Symbol">...</a> <a id="12123" class="Symbol">|</a> <a id="12125" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12129" href="exploration.html#12129" class="Bound">x</a> <a id="12131" class="Symbol">|</a> <a id="12133" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12137" href="exploration.html#12137" class="Bound">y</a> <a id="12139" class="Symbol">=</a> <a id="12141" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12145" href="Cubical.HITs.FiniteMultiset.Base.html#436" class="InductiveConstructor Operator">[</a> <a id="12147" class="Symbol">(</a><a id="12148" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12152" class="Symbol">(</a><a id="12153" href="exploration.html#12129" class="Bound">x</a> <a id="12155" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="12157" href="exploration.html#12137" class="Bound">y</a><a id="12158" class="Symbol">))</a> <a id="12161" href="Cubical.HITs.FiniteMultiset.Base.html#436" class="InductiveConstructor Operator">]</a>
  <a id="12165" class="Symbol">...</a> <a id="12169" class="Symbol">|</a> <a id="12171" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12175" href="exploration.html#12175" class="Bound">x</a> <a id="12177" class="Symbol">|</a> <a id="12179" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12183" href="exploration.html#12183" class="Bound">y</a> <a id="12185" class="Symbol">=</a> <a id="12187" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12191" class="Symbol">(</a><a id="12192" href="exploration.html#11439" class="Function">map</a> <a id="12196" class="Symbol">(λ</a> <a id="12199" href="exploration.html#12199" class="Bound">y</a> <a id="12201" class="Symbol">→</a> <a id="12203" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="12207" class="Symbol">(</a><a id="12208" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12212" href="exploration.html#12175" class="Bound">x</a><a id="12213" class="Symbol">)</a> <a id="12215" href="exploration.html#12199" class="Bound">y</a><a id="12216" class="Symbol">)</a> <a id="12218" href="exploration.html#12183" class="Bound">y</a><a id="12219" class="Symbol">)</a>
  <a id="12223" class="Symbol">...</a> <a id="12227" class="Symbol">|</a> <a id="12229" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12233" href="exploration.html#12233" class="Bound">x</a> <a id="12235" class="Symbol">|</a> <a id="12237" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12241" href="exploration.html#12241" class="Bound">y</a> <a id="12243" class="Symbol">=</a> <a id="12245" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12249" class="Symbol">(</a><a id="12250" href="exploration.html#11439" class="Function">map</a> <a id="12254" class="Symbol">(λ</a> <a id="12257" href="exploration.html#12257" class="Bound">x</a> <a id="12259" class="Symbol">→</a> <a id="12261" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="12265" href="exploration.html#12257" class="Bound">x</a> <a id="12267" class="Symbol">(</a><a id="12268" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12272" href="exploration.html#12241" class="Bound">y</a><a id="12273" class="Symbol">))</a> <a id="12276" href="exploration.html#12233" class="Bound">x</a><a id="12277" class="Symbol">)</a>
  <a id="12281" class="Symbol">...</a> <a id="12285" class="Symbol">|</a> <a id="12287" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12291" href="exploration.html#12291" class="Bound">x</a> <a id="12293" class="Symbol">|</a> <a id="12295" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12299" href="exploration.html#12299" class="Bound">y</a> <a id="12301" class="Symbol">=</a> <a id="12303" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12307" class="Symbol">((</a><a id="12309" href="exploration.html#11439" class="Function">map</a> <a id="12313" class="Symbol">(λ</a> <a id="12316" href="exploration.html#12316" class="Bound">x</a> <a id="12318" class="Symbol">→</a> <a id="12320" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="12324" href="exploration.html#12316" class="Bound">x</a> <a id="12326" class="Bound">t₂</a><a id="12328" class="Symbol">)</a> <a id="12330" href="exploration.html#12291" class="Bound">x</a><a id="12331" class="Symbol">)</a> <a id="12333" href="Cubical.HITs.FiniteMultiset.Properties.html#459" class="Function Operator">++</a> <a id="12336" href="exploration.html#11439" class="Function">map</a> <a id="12340" class="Symbol">(λ</a> <a id="12343" href="exploration.html#12343" class="Bound">y</a> <a id="12345" class="Symbol">→</a> <a id="12347" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="12351" class="Bound">t₁</a> <a id="12354" href="exploration.html#12343" class="Bound">y</a><a id="12355" class="Symbol">)</a> <a id="12357" href="exploration.html#12299" class="Bound">y</a><a id="12358" class="Symbol">)</a>
  <a id="12362" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12369" class="Symbol">(</a><a id="12370" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="12375" href="exploration.html#12375" class="Bound">t₁</a> <a id="12378" href="exploration.html#12378" class="Bound">t₂</a> <a id="12381" href="exploration.html#12381" class="Bound">i</a><a id="12382" class="Symbol">)</a> <a id="12384" class="Keyword">with</a> <a id="12389" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12396" href="exploration.html#12375" class="Bound">t₁</a> <a id="12399" class="Symbol">|</a> <a id="12401" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12408" href="exploration.html#12378" class="Bound">t₂</a> 
  <a id="12414" class="Symbol">...</a> <a id="12418" class="Symbol">|</a> <a id="12420" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12424" href="exploration.html#12424" class="Bound">x</a> <a id="12426" class="Symbol">|</a> <a id="12428" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12432" href="exploration.html#12432" class="Bound">y</a> <a id="12434" class="Symbol">=</a> <a id="12436" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12440" href="Cubical.HITs.FiniteMultiset.Base.html#436" class="InductiveConstructor Operator">[</a> <a id="12442" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12446" class="Symbol">(</a><a id="12447" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="12454" href="exploration.html#12424" class="Bound">x</a> <a id="12456" href="exploration.html#12432" class="Bound">y</a> <a id="12458" class="Bound">i</a><a id="12459" class="Symbol">)</a> <a id="12461" href="Cubical.HITs.FiniteMultiset.Base.html#436" class="InductiveConstructor Operator">]</a>
  <a id="12465" class="Symbol">...</a> <a id="12469" class="Symbol">|</a> <a id="12471" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12475" href="exploration.html#12475" class="Bound">x</a> <a id="12477" class="Symbol">|</a> <a id="12479" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12483" href="exploration.html#12483" class="Bound">y</a> <a id="12485" class="Symbol">=</a> <a id="12487" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12491" class="Symbol">(</a><a id="12492" href="exploration.html#11439" class="Function">map</a> <a id="12496" class="Symbol">(λ</a> <a id="12499" href="exploration.html#12499" class="Bound">y</a> <a id="12501" class="Symbol">→</a> <a id="12503" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="12508" class="Symbol">(</a><a id="12509" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12513" href="exploration.html#12475" class="Bound">x</a><a id="12514" class="Symbol">)</a> <a id="12516" href="exploration.html#12499" class="Bound">y</a> <a id="12518" class="Bound">i</a><a id="12519" class="Symbol">)</a> <a id="12521" href="exploration.html#12483" class="Bound">y</a><a id="12522" class="Symbol">)</a>
  <a id="12526" class="Symbol">...</a> <a id="12530" class="Symbol">|</a> <a id="12532" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12536" href="exploration.html#12536" class="Bound">x</a> <a id="12538" class="Symbol">|</a> <a id="12540" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12544" href="exploration.html#12544" class="Bound">y</a> <a id="12546" class="Symbol">=</a> <a id="12548" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12552" class="Symbol">(</a><a id="12553" href="exploration.html#11439" class="Function">map</a> <a id="12557" class="Symbol">(λ</a> <a id="12560" href="exploration.html#12560" class="Bound">x</a> <a id="12562" class="Symbol">→</a> <a id="12564" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="12569" href="exploration.html#12560" class="Bound">x</a> <a id="12571" class="Symbol">(</a><a id="12572" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="12576" href="exploration.html#12544" class="Bound">y</a><a id="12577" class="Symbol">)</a> <a id="12579" class="Bound">i</a><a id="12580" class="Symbol">)</a> <a id="12582" href="exploration.html#12536" class="Bound">x</a><a id="12583" class="Symbol">)</a>
  <a id="12587" class="Symbol">...</a> <a id="12591" class="Symbol">|</a> <a id="12593" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12597" href="exploration.html#12597" class="Bound">x</a> <a id="12599" class="Symbol">|</a> <a id="12601" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12605" href="exploration.html#12605" class="Bound">y</a> <a id="12607" class="Symbol">=</a> <a id="12609" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12613" class="Symbol">(</a><a id="12614" href="Cubical.HITs.FiniteMultiset.Properties.html#1229" class="Function">comm-++</a> <a id="12622" class="Symbol">(</a><a id="12623" href="exploration.html#11439" class="Function">map</a> <a id="12627" class="Symbol">(λ</a> <a id="12630" href="exploration.html#12630" class="Bound">x</a> <a id="12632" class="Symbol">→</a> <a id="12634" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="12639" href="exploration.html#12630" class="Bound">x</a> <a id="12641" class="Bound">t₂</a> <a id="12644" class="Bound">i</a><a id="12645" class="Symbol">)</a> <a id="12647" href="exploration.html#12597" class="Bound">x</a><a id="12648" class="Symbol">)</a> <a id="12650" class="Symbol">(</a><a id="12651" href="exploration.html#11439" class="Function">map</a> <a id="12655" class="Symbol">(λ</a> <a id="12658" href="exploration.html#12658" class="Bound">y</a> <a id="12660" class="Symbol">→</a> <a id="12662" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="12667" class="Bound">t₁</a> <a id="12670" href="exploration.html#12658" class="Bound">y</a> <a id="12672" class="Bound">i</a><a id="12673" class="Symbol">)</a> <a id="12675" href="exploration.html#12605" class="Bound">y</a><a id="12676" class="Symbol">)</a> <a id="12678" class="Bound">i</a><a id="12679" class="Symbol">)</a>

  <a id="12684" href="exploration.html#12684" class="Function">trans</a> <a id="12690" class="Symbol">:</a> <a id="12692" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="12699" class="Symbol">→</a> <a id="12701" href="Cubical.HITs.FiniteMultiset.Base.html#259" class="Datatype">FMSet</a> <a id="12707" href="exploration.html#1159" class="Datatype">Hutton</a>
  <a id="12716" href="exploration.html#12684" class="Function">trans</a> <a id="12722" href="exploration.html#12722" class="Bound">t</a> <a id="12724" class="Keyword">with</a> <a id="12729" href="exploration.html#12008" class="Function">trans&#39;</a> <a id="12736" href="exploration.html#12722" class="Bound">t</a> 
  <a id="12741" class="Symbol">...</a> <a id="12745" class="Symbol">|</a> <a id="12747" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="12751" href="exploration.html#12751" class="Bound">x</a> <a id="12753" class="Symbol">=</a> <a id="12755" href="Cubical.HITs.FiniteMultiset.Base.html#295" class="InductiveConstructor">[]</a>
  <a id="12760" class="Symbol">...</a> <a id="12764" class="Symbol">|</a> <a id="12766" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="12770" href="exploration.html#12770" class="Bound">x</a> <a id="12772" class="Symbol">=</a> <a id="12774" href="exploration.html#12770" class="Bound">x</a>
<a id="12776" class="Markup">```
</a><a id="12780" class="Background">
The definition of exec though requires a rose tree, and hence we run into problems of termination. `--size-types` don&#39;t seem to work well with `--cubical`, atleast I was getting hard crashes every time I tried using them. 

Instead we introduce a sized hutton type.

</a><a id="13048" class="Markup">```
</a>  <a id="13054" class="Keyword">data</a> <a id="13059" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13067" class="Symbol">:</a> <a id="13069" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="13071" class="Symbol">→</a> <a id="13073" href="Agda.Primitive.html#326" class="Primitive">Type₀</a> <a id="13079" class="Keyword">where</a>
    <a id="13089" href="exploration.html#13089" class="InductiveConstructor">val</a>  <a id="13094" class="Symbol">:</a> <a id="13096" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="13098" class="Symbol">→</a> <a id="13100" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13108" class="Number">0</a>
    <a id="13114" href="exploration.html#13114" class="InductiveConstructor">add</a>  <a id="13119" class="Symbol">:</a> <a id="13121" class="Symbol">∀</a> <a id="13123" class="Symbol">{</a><a id="13124" href="exploration.html#13124" class="Bound">n</a> <a id="13126" href="exploration.html#13126" class="Bound">m</a><a id="13127" class="Symbol">}</a> <a id="13129" class="Symbol">→</a> <a id="13131" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13139" href="exploration.html#13124" class="Bound">n</a> <a id="13141" class="Symbol">→</a> <a id="13143" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13151" href="exploration.html#13126" class="Bound">m</a> <a id="13153" class="Symbol">→</a> <a id="13155" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13163" class="Symbol">(</a><a id="13164" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13168" class="Symbol">(</a><a id="13169" href="exploration.html#13124" class="Bound">n</a> <a id="13171" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="13173" href="exploration.html#13126" class="Bound">m</a><a id="13174" class="Symbol">))</a>
    <a id="13181" href="exploration.html#13181" class="InductiveConstructor">comm</a> <a id="13186" class="Symbol">:</a> <a id="13188" class="Symbol">∀</a> <a id="13190" class="Symbol">{</a><a id="13191" href="exploration.html#13191" class="Bound">n</a> <a id="13193" href="exploration.html#13193" class="Bound">m</a><a id="13194" class="Symbol">}</a> <a id="13196" class="Symbol">(</a><a id="13197" href="exploration.html#13197" class="Bound">x</a> <a id="13199" class="Symbol">:</a> <a id="13201" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13209" href="exploration.html#13191" class="Bound">n</a><a id="13210" class="Symbol">)</a> <a id="13212" class="Symbol">(</a><a id="13213" href="exploration.html#13213" class="Bound">y</a> <a id="13215" class="Symbol">:</a> <a id="13217" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13225" href="exploration.html#13193" class="Bound">m</a><a id="13226" class="Symbol">)</a> <a id="13228" class="Symbol">→</a> <a id="13230" href="Agda.Builtin.Cubical.Path.html#190" class="Postulate">PathP</a> <a id="13236" class="Symbol">(λ</a> <a id="13239" href="exploration.html#13239" class="Bound">i</a> <a id="13241" class="Symbol">→</a> <a id="13243" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13251" class="Symbol">(</a><a id="13252" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13256" class="Symbol">(</a><a id="13257" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="13264" href="exploration.html#13191" class="Bound">n</a> <a id="13266" href="exploration.html#13193" class="Bound">m</a> <a id="13268" href="exploration.html#13239" class="Bound">i</a><a id="13269" class="Symbol">)))</a> <a id="13273" class="Symbol">(</a><a id="13274" href="exploration.html#13114" class="InductiveConstructor">add</a> <a id="13278" href="exploration.html#13197" class="Bound">x</a> <a id="13280" href="exploration.html#13213" class="Bound">y</a><a id="13281" class="Symbol">)</a> <a id="13283" class="Symbol">(</a><a id="13284" href="exploration.html#13114" class="InductiveConstructor">add</a> <a id="13288" href="exploration.html#13213" class="Bound">y</a> <a id="13290" href="exploration.html#13197" class="Bound">x</a><a id="13291" class="Symbol">)</a>

  <a id="13296" href="exploration.html#13296" class="Function">toSized</a> <a id="13304" class="Symbol">:</a> <a id="13306" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="13313" class="Symbol">→</a> <a id="13315" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="13317" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="13319" href="exploration.html#13059" class="Datatype">SHutton</a>
  <a id="13329" href="exploration.html#13296" class="Function">toSized</a> <a id="13337" class="Symbol">(</a><a id="13338" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="13342" href="exploration.html#13342" class="Bound">x</a><a id="13343" class="Symbol">)</a> <a id="13345" class="Symbol">=</a> <a id="13347" class="Number">0</a> <a id="13349" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13351" class="Symbol">(</a><a id="13352" href="exploration.html#13089" class="InductiveConstructor">val</a> <a id="13356" href="exploration.html#13342" class="Bound">x</a><a id="13357" class="Symbol">)</a>
  <a id="13361" href="exploration.html#13296" class="Function">toSized</a> <a id="13369" class="Symbol">(</a><a id="13370" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="13374" href="exploration.html#13374" class="Bound">t₁</a> <a id="13377" href="exploration.html#13377" class="Bound">t₂</a><a id="13379" class="Symbol">)</a> <a id="13381" class="Keyword">with</a> <a id="13386" href="exploration.html#13296" class="Function">toSized</a> <a id="13394" href="exploration.html#13374" class="Bound">t₁</a> <a id="13397" class="Symbol">|</a> <a id="13399" href="exploration.html#13296" class="Function">toSized</a> <a id="13407" href="exploration.html#13377" class="Bound">t₂</a>
  <a id="13412" class="Symbol">...</a> <a id="13416" class="Symbol">|</a> <a id="13418" href="exploration.html#13418" class="Bound">n</a> <a id="13420" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13422" href="exploration.html#13422" class="Bound">st₁</a> <a id="13426" class="Symbol">|</a> <a id="13428" href="exploration.html#13428" class="Bound">m</a> <a id="13430" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13432" href="exploration.html#13432" class="Bound">st₂</a> <a id="13436" class="Symbol">=</a> <a id="13438" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13442" class="Symbol">(</a><a id="13443" href="exploration.html#13418" class="Bound">n</a> <a id="13445" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="13447" href="exploration.html#13428" class="Bound">m</a><a id="13448" class="Symbol">)</a> <a id="13450" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13452" href="exploration.html#13114" class="InductiveConstructor">add</a> <a id="13456" href="exploration.html#13422" class="Bound">st₁</a> <a id="13460" href="exploration.html#13432" class="Bound">st₂</a>
  <a id="13466" href="exploration.html#13296" class="Function">toSized</a> <a id="13474" class="Symbol">(</a><a id="13475" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="13480" href="exploration.html#13480" class="Bound">t₁</a> <a id="13483" href="exploration.html#13483" class="Bound">t₂</a> <a id="13486" href="exploration.html#13486" class="Bound">i</a><a id="13487" class="Symbol">)</a> <a id="13489" class="Keyword">with</a> <a id="13494" href="exploration.html#13296" class="Function">toSized</a> <a id="13502" href="exploration.html#13480" class="Bound">t₁</a> <a id="13505" class="Symbol">|</a> <a id="13507" href="exploration.html#13296" class="Function">toSized</a> <a id="13515" href="exploration.html#13483" class="Bound">t₂</a>
  <a id="13520" class="Symbol">...</a> <a id="13524" class="Symbol">|</a> <a id="13526" href="exploration.html#13526" class="Bound">n</a> <a id="13528" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13530" href="exploration.html#13530" class="Bound">st₁</a> <a id="13534" class="Symbol">|</a> <a id="13536" href="exploration.html#13536" class="Bound">m</a> <a id="13538" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13540" href="exploration.html#13540" class="Bound">st₂</a> <a id="13544" class="Symbol">=</a> <a id="13546" class="Symbol">(</a><a id="13547" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13551" class="Symbol">(</a><a id="13552" href="Cubical.Data.Nat.Properties.html#1765" class="Function">+-comm</a> <a id="13559" href="exploration.html#13526" class="Bound">n</a> <a id="13561" href="exploration.html#13536" class="Bound">m</a> <a id="13563" class="Bound">i</a><a id="13564" class="Symbol">))</a> <a id="13567" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13569" class="Symbol">(</a><a id="13570" href="exploration.html#13181" class="InductiveConstructor">comm</a> <a id="13575" href="exploration.html#13530" class="Bound">st₁</a> <a id="13579" href="exploration.html#13540" class="Bound">st₂</a> <a id="13583" class="Bound">i</a><a id="13584" class="Symbol">)</a>

  <a id="13589" href="exploration.html#13589" class="Function">fromSized</a> <a id="13599" class="Symbol">:</a> <a id="13601" class="Symbol">∀</a> <a id="13603" class="Symbol">{</a><a id="13604" href="exploration.html#13604" class="Bound">n</a><a id="13605" class="Symbol">}</a> <a id="13607" class="Symbol">→</a> <a id="13609" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="13617" href="exploration.html#13604" class="Bound">n</a> <a id="13619" class="Symbol">→</a> <a id="13621" href="exploration.html#1159" class="Datatype">Hutton</a>
  <a id="13630" href="exploration.html#13589" class="Function">fromSized</a> <a id="13640" class="Symbol">(</a><a id="13641" href="exploration.html#13089" class="InductiveConstructor">val</a> <a id="13645" href="exploration.html#13645" class="Bound">x</a><a id="13646" class="Symbol">)</a> <a id="13648" class="Symbol">=</a> <a id="13650" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="13654" href="exploration.html#13645" class="Bound">x</a>
  <a id="13658" href="exploration.html#13589" class="Function">fromSized</a> <a id="13668" class="Symbol">(</a><a id="13669" href="exploration.html#13114" class="InductiveConstructor">add</a> <a id="13673" href="exploration.html#13673" class="Bound">t₁</a> <a id="13676" href="exploration.html#13676" class="Bound">t₂</a><a id="13678" class="Symbol">)</a> <a id="13680" class="Symbol">=</a> <a id="13682" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="13686" class="Symbol">(</a><a id="13687" href="exploration.html#13589" class="Function">fromSized</a> <a id="13697" href="exploration.html#13673" class="Bound">t₁</a><a id="13699" class="Symbol">)</a> <a id="13701" class="Symbol">(</a><a id="13702" href="exploration.html#13589" class="Function">fromSized</a> <a id="13712" href="exploration.html#13676" class="Bound">t₂</a><a id="13714" class="Symbol">)</a>
  <a id="13718" href="exploration.html#13589" class="Function">fromSized</a> <a id="13728" class="Symbol">(</a><a id="13729" href="exploration.html#13181" class="InductiveConstructor">comm</a> <a id="13734" href="exploration.html#13734" class="Bound">t₁</a> <a id="13737" href="exploration.html#13737" class="Bound">t₂</a> <a id="13740" href="exploration.html#13740" class="Bound">i</a><a id="13741" class="Symbol">)</a> <a id="13743" class="Symbol">=</a> <a id="13745" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="13750" class="Symbol">(</a><a id="13751" href="exploration.html#13589" class="Function">fromSized</a> <a id="13761" href="exploration.html#13734" class="Bound">t₁</a><a id="13763" class="Symbol">)</a> <a id="13765" class="Symbol">(</a><a id="13766" href="exploration.html#13589" class="Function">fromSized</a> <a id="13776" href="exploration.html#13737" class="Bound">t₂</a><a id="13778" class="Symbol">)</a> <a id="13780" href="exploration.html#13740" class="Bound">i</a>
  
  <a id="13787" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="13805" class="Symbol">:</a> <a id="13807" class="Symbol">∀</a> <a id="13809" class="Symbol">(</a><a id="13810" href="exploration.html#13810" class="Bound">t</a> <a id="13812" class="Symbol">:</a> <a id="13814" href="exploration.html#1159" class="Datatype">Hutton</a><a id="13820" class="Symbol">)</a> <a id="13822" class="Symbol">→</a> <a id="13824" href="exploration.html#13589" class="Function">fromSized</a> <a id="13834" class="Symbol">(</a><a id="13835" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a> <a id="13839" class="Symbol">(</a><a id="13840" href="exploration.html#13296" class="Function">toSized</a> <a id="13848" href="exploration.html#13810" class="Bound">t</a><a id="13849" class="Symbol">))</a> <a id="13852" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="13854" href="exploration.html#13810" class="Bound">t</a>
  <a id="13858" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="13876" class="Symbol">(</a><a id="13877" href="exploration.html#1182" class="InductiveConstructor">val</a> <a id="13881" href="exploration.html#13881" class="Bound">x</a><a id="13882" class="Symbol">)</a> <a id="13884" class="Symbol">=</a> <a id="13886" href="Cubical.Foundations.Prelude.html#870" class="Function">refl</a>
  <a id="13893" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="13911" class="Symbol">(</a><a id="13912" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="13916" href="exploration.html#13916" class="Bound">t₁</a> <a id="13919" href="exploration.html#13919" class="Bound">t₂</a><a id="13921" class="Symbol">)</a> <a id="13923" class="Symbol">=</a> <a id="13925" href="Cubical.Foundations.Prelude.html#1236" class="Function">cong₂</a> <a id="13931" href="exploration.html#1201" class="InductiveConstructor">add</a> <a id="13935" class="Symbol">(</a><a id="13936" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="13954" href="exploration.html#13916" class="Bound">t₁</a><a id="13956" class="Symbol">)</a> <a id="13958" class="Symbol">(</a><a id="13959" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="13977" href="exploration.html#13919" class="Bound">t₂</a><a id="13979" class="Symbol">)</a>
  <a id="13983" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="14001" class="Symbol">(</a><a id="14002" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="14007" href="exploration.html#14007" class="Bound">t₁</a> <a id="14010" href="exploration.html#14010" class="Bound">t₂</a> <a id="14013" href="exploration.html#14013" class="Bound">i</a><a id="14014" class="Symbol">)</a> <a id="14016" href="exploration.html#14016" class="Bound">j</a> <a id="14018" class="Symbol">=</a> <a id="14020" href="exploration.html#1235" class="InductiveConstructor">comm</a> <a id="14025" class="Symbol">(</a><a id="14026" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="14044" href="exploration.html#14007" class="Bound">t₁</a> <a id="14047" href="exploration.html#14016" class="Bound">j</a><a id="14048" class="Symbol">)</a> <a id="14050" class="Symbol">(</a><a id="14051" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="14069" href="exploration.html#14010" class="Bound">t₂</a> <a id="14072" href="exploration.html#14016" class="Bound">j</a><a id="14073" class="Symbol">)</a> <a id="14075" href="exploration.html#14013" class="Bound">i</a>

  <a id="14080" class="Comment">-- commutativity case doesn&#39;t seem to go through...</a>
  <a id="14134" class="Keyword">postulate</a> <a id="14144" href="exploration.html#14144" class="Postulate">toSized-fromSized</a> <a id="14162" class="Symbol">:</a> <a id="14164" class="Symbol">∀</a> <a id="14166" class="Symbol">{</a><a id="14167" href="exploration.html#14167" class="Bound">n</a><a id="14168" class="Symbol">}</a> <a id="14170" class="Symbol">(</a><a id="14171" href="exploration.html#14171" class="Bound">t</a> <a id="14173" class="Symbol">:</a> <a id="14175" href="exploration.html#13059" class="Datatype">SHutton</a> <a id="14183" href="exploration.html#14167" class="Bound">n</a><a id="14184" class="Symbol">)</a> <a id="14186" class="Symbol">→</a> <a id="14188" href="exploration.html#13296" class="Function">toSized</a> <a id="14196" class="Symbol">(</a><a id="14197" href="exploration.html#13589" class="Function">fromSized</a> <a id="14207" href="exploration.html#14171" class="Bound">t</a><a id="14208" class="Symbol">)</a> <a id="14210" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="14212" class="Symbol">(</a><a id="14213" href="exploration.html#14167" class="Bound">n</a> <a id="14215" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14217" href="exploration.html#14171" class="Bound">t</a><a id="14218" class="Symbol">)</a>
  <a id="14222" class="Comment">-- toSized-fromSized (val x) = refl</a>
  <a id="14260" class="Comment">-- toSized-fromSized (add t₁ t₂) with PathPΣ (toSized-fromSized t₁) | PathPΣ (toSized-fromSized t₂)</a>
  <a id="14362" class="Comment">-- ... | fst₁ , snd₁ | fst₂ , snd₂ = ΣPathP ((λ j → suc (fst₁ j + fst₂ j)) , λ j → add (snd₁ j) (snd₂ j))</a>
  <a id="14470" class="Comment">-- toSized-fromSized (comm {n} {m} t₁ t₂ i) with PathPΣ (toSized-fromSized t₁) | PathPΣ (toSized-fromSized t₂)</a>
  <a id="14583" class="Comment">-- ... | fst₁ , snd₁ | fst₂ , snd₂ = {!   !}</a>
  <a id="14630" class="Comment">--   -- ΣPathP ((cong₂ (λ a b → suc (+-comm a b i)) fst₁ fst₂) , cong₂ (λ a b → comm a b i) snd₁ snd₂)</a>
  
  <a id="14738" href="exploration.html#14738" class="Function">Hutton≃SHutton</a> <a id="14753" class="Symbol">:</a> <a id="14755" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="14762" href="Agda.Builtin.Cubical.Glue.html#1051" class="Function Operator">≃</a> <a id="14764" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="14766" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="14768" href="exploration.html#13059" class="Datatype">SHutton</a>
  <a id="14778" href="exploration.html#14738" class="Function">Hutton≃SHutton</a> <a id="14793" class="Symbol">=</a> <a id="14795" href="Cubical.Foundations.Isomorphism.html#3124" class="Function">isoToEquiv</a> <a id="14806" href="exploration.html#14826" class="Function">lemma</a>
    <a id="14816" class="Keyword">where</a>
    <a id="14826" href="exploration.html#14826" class="Function">lemma</a> <a id="14832" class="Symbol">:</a> <a id="14834" href="Cubical.Foundations.Isomorphism.html#770" class="Record">Iso</a> <a id="14838" href="exploration.html#1159" class="Datatype">Hutton</a> <a id="14845" class="Symbol">(</a><a id="14846" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="14848" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="14850" href="exploration.html#13059" class="Datatype">SHutton</a><a id="14857" class="Symbol">)</a>
    <a id="14863" href="Cubical.Foundations.Isomorphism.html#882" class="Field">Iso.fun</a> <a id="14871" href="exploration.html#14826" class="Function">lemma</a> <a id="14877" class="Symbol">=</a> <a id="14879" href="exploration.html#13296" class="Function">toSized</a>
    <a id="14891" href="Cubical.Foundations.Isomorphism.html#898" class="Field">Iso.inv</a> <a id="14899" href="exploration.html#14826" class="Function">lemma</a> <a id="14905" class="Symbol">(_</a> <a id="14908" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14910" href="exploration.html#14910" class="Bound">t</a><a id="14911" class="Symbol">)</a> <a id="14913" class="Symbol">=</a> <a id="14915" href="exploration.html#13589" class="Function">fromSized</a> <a id="14925" href="exploration.html#14910" class="Bound">t</a>
    <a id="14931" href="Cubical.Foundations.Isomorphism.html#914" class="Field">Iso.rightInv</a> <a id="14944" href="exploration.html#14826" class="Function">lemma</a> <a id="14950" class="Symbol">(</a><a id="14951" href="exploration.html#14951" class="Bound">n</a> <a id="14953" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14955" href="exploration.html#14955" class="Bound">t</a><a id="14956" class="Symbol">)</a> <a id="14958" class="Symbol">=</a> <a id="14960" href="exploration.html#14144" class="Postulate">toSized-fromSized</a> <a id="14978" href="exploration.html#14955" class="Bound">t</a>
    <a id="14984" href="Cubical.Foundations.Isomorphism.html#945" class="Field">Iso.leftInv</a> <a id="14996" href="exploration.html#14826" class="Function">lemma</a> <a id="15002" href="exploration.html#15002" class="Bound">t</a> <a id="15004" class="Symbol">=</a> <a id="15006" href="exploration.html#13787" class="Function">fromSized-toSized</a> <a id="15024" href="exploration.html#15002" class="Bound">t</a>
<a id="15026" class="Markup">```
</a><a id="15030" class="Background">
The result of exec is a rose tree, but since we have the commutativity condition, the children will be a set. The size parameter here resolves all the termination problems you get with rose trees.

```none
  data RoseSetTree {ℓ} (A : ℕ → Type ℓ) : ℕ → Type ℓ where
    leaf : A 0 → RoseSetTree A 0
    node : ∀ {n} → A (suc n) → FMSet (RoseSetTree A n) → RoseSetTree A (suc n)

  SHuttonTree : ℕ → Type₀
  SHuttonTree n = RoseSetTree SHutton n

  -- data SHuttonTree : ℕ → Type₀ where
  --   leaf : SHutton 0 → SHuttonTree 0
  --   node : ∀ {n} → SHutton (suc n) → FMSet (SHuttonTree n) → SHuttonTree (suc n)

  strans : ∀ {n} → SHutton (suc n) → FMSet (SHutton n)
  strans {.(zero + zero)} (add {zero} {zero} (val x) (val y)) = [ (val (x + y)) ]
  strans {.(zero + suc m)} (add {zero} {suc m} (val x) t) = map (λ z → add (val x) z) (strans t)
  strans {.(suc n + zero)} (add {suc n} {zero} t (val x)) = map (λ z → add z (val x)) (strans t)
  strans {.(suc n + suc m)} (add {suc n} {suc m} t₁ t₂) = 
    map (λ z → add z t₂) (strans t₁) ++ map (λ z → subst (λ x → SHutton (suc x)) (sym (+-suc n m)) (add t₁ z)) (strans t₂)
  strans (comm {zero} {zero} (val x) (val y) i) = [ (val (+-comm x y i)) ]
  strans (comm {zero} {suc m} (val x) t₂ i) = 
    map (lemma i) (strans t₂)
    where
    lemma : PathP (λ i → SHutton m → SHutton (+-comm zero (suc m) i)) 
                  (λ z → add {zero} {m} (val x) z) 
                  (λ z → add {m} {zero} z (val x))
    lemma = {!   !} --easy
  strans (comm {suc n} {zero} t₁ (val x) i) = 
    map (lemma i) (strans t₁)
    where
    lemma : PathP (λ i → SHutton m → SHutton (+-comm (suc m) zero i)) 
                  (λ z → add {m} {zero} z (val x))
                  (λ z → add {zero} {m} (val x) z) 
    lemma = {!   !} --easy
  strans (comm {suc n} {suc m} t₁ t₂ i) = {!   !} --fidilly
 
  exec : ∀ {n} → SHutton n → SHuttonTree n
  exec {zero} (val x) = leaf (val x)
  exec {suc n} t = node t (map exec (strans t))
```

However we still have problems with termination in unfold...

```none
  unfold : ∀ {ℓ} {A : ℕ → Type ℓ} {n} 
         → (∀ {n} → SHutton n → A n) 
         → (∀ {n} → SHutton (suc n) → FMSet (SHutton n)) 
         → SHutton n
         → RoseSetTree A n
  unfold {n = zero} f g t = leaf (f t)
  unfold {n = suc .(n + m)} f g t@(add {n} {m} t₁ t₂) = node (f t) (map (unfold {n = n + m} f g) (g t))
  --        ^----------------------------------------------------------------------^
  --  not sure why this doesnt pass the termination checker....
  unfold {n = suc .(+-comm n m i)} f g (comm {n} {m} t₁ t₂ i) = {!   !}
```
</a></pre></body></html>